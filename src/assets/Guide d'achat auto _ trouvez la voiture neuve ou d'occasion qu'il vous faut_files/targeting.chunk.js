(window.idzJsonpFunction=window.idzJsonpFunction||[]).push([[13],Array(49).concat([function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(22)),a=r(n(23)),o=r(n(20)),u=n(56),c=r(n(159)),l=r(n(25)),f=r(n(190)),s=r(n(195)),d=r(n(7));t.default=function(){var e,t,n=(0,u.getEventManager)();n.on(d.default.targetingRulesCreated,(function(t){var r=t.interactionRules;l.default.getDataPipeline().then((function(t){var i=t.default;(0,o.default)((function(){i(n,e,r)}))()})).catch((function(){}))})),n.on(d.default.visitorServiceCreated,(function(r){var i=r.visitorService;e&&t?(0,c.default)(e,t,i):n.on(d.default.targetingInitialized,(function(){(0,c.default)(e,t,i)}))})),(0,o.default)((0,a.default)(i.default.mark((function r(){var a;return i.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=(0,f.default)(),e=a.orchestratorDispatcher,t=a.clearCallbacksState,n.emit(d.default.targetingInitialized);case 4:case"end":return r.stop()}}),r)}))))(),(0,o.default)((function(){var e=(0,s.default)();n.emit(d.default.visitorServiceCreated,{visitorService:e})}))(),(0,o.default)((function(){l.default.getGDPRMiddleware().then((function(e){var t=e.default;(0,o.default)((function(){t.register()}))()})).catch((function(){n.emit(d.default.tagLivechatStop),n.emit(d.default.tagOrchestratorStop)}))}))()}},,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),t.default=function(){}},function(e,t,n){"use strict";n.r(t);var r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},i=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.reduce((function(e,t,n){var a=0===n?e:[e];return t.apply(void 0,i([],r(a)))}),t)}}},,,,,,,function(e,t,n){var r=n(162);e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},,function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,a=n(56),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(62)),u=r(n(57)),c=r(n(15));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}var f=function(){if(i)return i;var e=(0,a.getIdz)(),t={},n=function(n){var r=n;r||(r=t,t={});var i=e.chaturl+"rpc/jsonstore.php?"+function(e,t){return["sid="+t.website_id,"u="+t.vuid,"data="+encodeURIComponent(JSON.stringify(e)),"callback=?"].join("&")}(r,e);return o.ajaxGet({url:i,isJson:!1}).then((function(e){return e&&"?()"!==e?u.default.reject(e):u.default.resolve()}))},r=(0,c.default)(n,1600);return i={saveData:function(e){Object.entries(e).forEach((function(e){var n=e[0],r=e[1];t[n]=r})),r()},save:n,onSave:function(e){(void 0).saveData(e)}}};t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(81);t.AVATAR_TYPES=r.AVATAR_TYPES,t.CHANNELS=r.CHANNELS,t.CHANNELS_ICONS_MAPPING=r.CHANNELS_ICONS_MAPPING,t.DEFAULT_COLOR=r.DEFAULT_COLOR,t.DEFAULT_FONT=r.DEFAULT_FONT,t.DEFAULT_FONT_SIZE_RATIO=r.DEFAULT_FONT_SIZE_RATIO,t.DEFAULT_TEXT_COLOR=r.DEFAULT_TEXT_COLOR,t.ICONS=r.ICONS,t.LANGUAGE_CODES=r.LANGUAGE_CODES,t.MEDIA_TYPES=r.MEDIA_TYPES,t.MESSENGER_STYLE=r.MESSENGER_STYLE,t.OFFSET_MAX=r.OFFSET_MAX,t.OFFSET_MAX_MOBILE=r.OFFSET_MAX_MOBILE,t.SIMPLE_TEMPLATED_NOTIFICATION_POSITIONS=r.SIMPLE_TEMPLATED_NOTIFICATION_POSITIONS,t.TEMPLATED_MOBILE_NOTIFICATION_TYPES=r.TEMPLATED_MOBILE_NOTIFICATION_TYPES,t.TEMPLATED_NOTIFICATION_BORDER_RADIUS_DEFAULT_VALUE=r.TEMPLATED_NOTIFICATION_BORDER_RADIUS_DEFAULT_VALUE,t.TEMPLATED_NOTIFICATION_FONTS_CSS=r.TEMPLATED_NOTIFICATION_FONTS_CSS,t.TEMPLATED_NOTIFICATION_POSITIONS=r.TEMPLATED_NOTIFICATION_POSITIONS,t.TEMPLATED_NOTIFICATION_TYPES=r.TEMPLATED_NOTIFICATION_TYPES,t.WHATSAPP_STYLE=r.WHATSAPP_STYLE},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.JSONStringify=function(e){for(var t="",n=["Array","Object","String"],r={},i=0;i<n.length;i++)window[n[i]].prototype.toJSON&&(r[n[i]]=window[n[i]].prototype.toJSON,delete window[n[i]].prototype.toJSON);try{t=JSON.stringify(e)}catch(e){}finally{for(var a in r)r.hasOwnProperty(a)&&(window[a].prototype.toJSON=r[a])}return t}},,,function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(73)),a=n(101),o=n(56),u=function(){function e(e){var t=this;this.executed=!1,this.closed=!1,Object.keys(e).forEach((function(n){t[n]=e[n]}))}e.canHandle=function(e){return!1};var t=e.prototype;return t.getContainerId=function(){return null},t.execute=function(e,t,n){this.executed=!0,this.recordExecution()},t.recordExecution=function(){},t.doSideEffectsOnClick=function(e){var t=(0,o.getIdz)();t.flags.proactif_activatedId=e,(0,i.default)().saveData({proactif_activatedId:t.flags.proactif_activatedId})},t.cancel=function(){this.executed=!1},t.close=function(){if(!this.isVisible())throw new Error("A non-visible action cannot be closed");this.closed=!0,this.cancel()},t.untrigger=function(){this.closed=!1,this.executed&&this.cancel()},t.isAvailable=function(e){return!0},t.isExecuted=function(){return this.executed},t.isClosed=function(){return this.closed},t.isVisible=function(){return this.visible},t.shouldIncrementExecutionCount=function(){return!0},t.canBeDisplayed=function(e){return this.isAvailable(e)&&this.isVisible()},t.isCapped=function(){return!this.overrideCapping&&(0,a.isNotificationDisplayCapped)()},t.shouldExecute=function(e){return!this.isExecuted()&&this.isAvailable(e)&&!this.isCapped()},t.shouldCancel=function(e){return this.isExecuted()&&!this.isAvailable(e)},e}();u.prototype.visible=!1;var c=u;t.default=c},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(166);function i(e){return(0,r.isSupported)()&&e.video.available}var a={chat:function(e){return e.chat.available},call:function(e){return e.call.available||e.callMeeting&&e.callMeeting.available&&e.callMeeting.enabled},visio:i,video:i,all:function(e){return a.chat(e)||a.call(e)},both:function(e){return a.all(e)},messenger:function(){return!0},sms:function(){return!0},"social-facebook-messenger-messageUs":function(){return!0},"social-facebook-messenger-sendToMessenger":function(){return!0},"social-facebook-messenger-chatbox":function(){return!0},"social-sms-desktop":function(){return!0},"social-sms-mobile":function(){return!0},"social-whatsapp-desktop":function(){return!0},"social-whatsapp-mobile":function(){return!0},whatsapp:function(){return!0},none:function(){return!1}},o={chat:function(e){return e.chat.busy},call:function(e){return e.call.busy},visio:function(e){return e.video.busy},all:function(e){return o.chat(e)||o.call(e)},both:function(e){return o.all(e)},none:function(){return!1}},u=function(e){return{isAvailable:a[e]||a.none,isBusy:o[e]||o.none}};t.default=u},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.isPrefetchableRuleFactory=void 0;var i=n(90),a=r(n(57)),o=function(e){var t=e.featureFlags["iadvize.livechat.auto-engage-on-rules"],n=t&&"false"!==t?t.split(","):[];return function(t,r){var i;return-1!==n.indexOf(t.toString())||-1!==n.indexOf(r.toString())||(null==(i=e.ProActif._datas)?void 0:i.some((function(e){return e.id===t&&e.routingRuleIsBot})))}};t.isPrefetchableRuleFactory=o;t.default=function(e){var t=e.curlang,n=e.website_id,r=o(e);return function(e,o){return o&&r(e,o)?(0,i.prefetchBotScenario)(o,n,t):a.default.resolve({data:[]})}}},function(e,t,n){"use strict";function r(e){var t={exports:{}};return e(t,t.exports),t.exports}var i,a=r((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.toHexString=t.isColor=t.Color=void 0;var n=function(){function e(e,t,n,r){this.red=e,this.green=t,this.blue=n,this.alpha=r}return e.prototype.toString=function(){return 1!==this.alpha?"rgba("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")":"rgb("+this.red+", "+this.green+", "+this.blue+")"},e}();t.Color=n,t.isColor=function(e){return e instanceof n},t.toHexString=function(e){var t=function(e){var t=e;return t<0&&(t=4294967295+t+1),t.toString(16).toUpperCase().padStart(2,"0")};return 1!==e.alpha?"#"+t(e.red)+t(e.green)+t(e.blue)+t(Math.round(255*e.alpha)):"#"+t(e.red)+t(e.green)+t(e.blue)}})),o=r((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isGradientLinear=t.GradientLinear=void 0;var n=function(){function e(e,t){this.angle=e,this.steps=t}return e.prototype.toString=function(){return"linear-gradient("+this.angle+"deg, "+this.steps.map((function(e){return e.color+" "+100*e.position+"%"})).join(", ")+")"},e}();t.GradientLinear=n,t.isGradientLinear=function(e){return e instanceof n}})),u=r((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isGradientRadial=t.GradientRadial=void 0;var n=function(){function e(e,t){this.position=e,this.steps=t}return e.prototype.toString=function(){return"radial-gradient("+this.position+", "+this.steps.map((function(e){return e.color+" "+100*e.position+"%"})).join(", ")+")"},e}();t.GradientRadial=n,t.isGradientRadial=function(e){return e instanceof n}})),c=r((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.COLOR=void 0,t.COLOR={AZURE:{200:new a.Color(230,245,255,1),300:new a.Color(153,214,255,1),400:new a.Color(77,184,255,1),500:new a.Color(0,153,255,1),DEFAULT:new a.Color(0,153,255,1)},FIREBRICK:{200:new a.Color(254,239,240,1),300:new a.Color(247,190,192,1),400:new a.Color(242,142,145,1),500:new a.Color(236,93,97,1),DEFAULT:new a.Color(236,93,97,1)},GREY:{"000":new a.Color(255,255,255,1),WHITE:new a.Color(255,255,255,1)},IBBU:{BLUE:new a.Color(204,235,255,1),GREEN:new a.Color(232,249,237,1),PINK:new a.Color(253,227,241,1),PURPLE:new a.Color(233,227,255,1),YELLOW:new a.Color(253,250,183,1)},JUICE:{200:new a.Color(255,244,230,1),300:new a.Color(255,209,153,1),400:new a.Color(255,175,77,1),500:new a.Color(255,140,0,1),DEFAULT:new a.Color(255,140,0,1)},MALACHITE:{200:new a.Color(233,250,238,1),300:new a.Color(164,233,184,1),400:new a.Color(96,216,132,1),500:new a.Color(27,199,78,1),DEFAULT:new a.Color(27,199,78,1)},NEUTRAL:{200:new a.Color(245,246,250,1),300:new a.Color(239,240,246,1),400:new a.Color(233,234,242,1),500:new a.Color(215,217,229,1),DEFAULT:new a.Color(215,217,229,1),600:new a.Color(164,169,188,1),700:new a.Color(107,113,132,1),800:new a.Color(55,61,77,1),900:new a.Color(52,57,63,1),"000":new a.Color(255,255,255,1)},SELECTIVE_YELLOW:{200:new a.Color(255,252,236,1),300:new a.Color(255,240,179,1),400:new a.Color(255,229,122,1),500:new a.Color(255,217,64,1),DEFAULT:new a.Color(255,217,64,1)},SKELETON:{BACKGROUNDGREY:new o.GradientLinear(90,[{position:0,color:new a.Color(239,240,246,1)},{position:.2708333432674408,color:new a.Color(233,234,242,1)},{position:1,color:new a.Color(215,217,229,1)}]),BACKGROUNDWHITE:new o.GradientLinear(90,[{position:.1041666641831398,color:new a.Color(245,246,250,1)},{position:.5885416865348816,color:new a.Color(239,240,246,1)},{position:1,color:new a.Color(233,234,242,1)}])},SOCIAL:{APPLE:new a.Color(87,87,87,1),FACEBOOK:new a.Color(24,119,242,1),MESSENGER:new u.GradientRadial("205% 195% at 5% 100%",[{position:0,color:new a.Color(72,152,251,1)},{position:.27419155836105347,color:new a.Color(67,114,250,1)},{position:.653188169002533,color:new a.Color(178,61,236,1)},{position:.8822097778320312,color:new a.Color(237,110,95,1)}]),TWITTER:new a.Color(29,161,242,1),WHATSAPP:new a.Color(37,211,102,1)},SPECTRUM:{200:new a.Color(243,240,255,1),300:new a.Color(205,191,255,1),400:new a.Color(168,144,255,1),500:new a.Color(130,96,255,1),DEFAULT:new a.Color(130,96,255,1)},WHITE:new a.Color(255,255,255,1)}})),l={CORNER_BOTTOM_RIGHT:"CORNER_BOTTOM_RIGHT",CORNER_BOTTOM_LEFT:"CORNER_BOTTOM_LEFT"},f={RIGHT:"RIGHT",LEFT:"LEFT"},s={OpenSans:"OpenSans",SourceSanspro:"SourceSansPro",Montserrat:"Montserrat",Lato:"Lato",Nunito:"Nunito",PTSerif:"PTSerif",Arial:"",Roboto:"Roboto",EBGaramond:"EbGaramond",Poppins:"Poppins"},d={BADGE:"BADGE",CLASSIC:"CLASSIC",MESSAGING:"MESSAGING",INVITATION:"INVITATION",FIXED:"FIXED"},p={BADGE:"BADGE",MESSAGING:"MESSAGING"},v={fontFamily:"Lato",url:"https://static.iadvize.com/ui/fonts/google-fonts/Lato.css"},g={fontColor:c.COLOR.NEUTRAL["000"].toString(),backgroundColor:c.COLOR.SOCIAL.MESSENGER.toString()},h={font:c.COLOR.NEUTRAL["000"].toString(),backgroundColor:c.COLOR.SOCIAL.WHATSAPP.toString()},O={AR:"AR",CA:"CA",CS:"CS",DA:"DA",DE:"DE",EL:"EL",EN:"EN",ES:"ES",EU:"EU",FR:"FR",HE:"HE",HU:"HU",IT:"IT",JA:"JA",KO:"KO",LT:"LT",NL:"NL",PL:"PL",PT:"PT",RO:"RO",RU:"RU",SE:"SE",TR:"TR",TW:"TW",UK:"UK",ZH:"ZH",SL:"SL",SK:"SK",HR:"HR",FI:"FI",BG:"BG",SR:"SR"},y={CHAT:"CHAT",CALL:"CALL",VIDEO:"VIDEO",MESSENGER:"MESSENGER",SMS:"SMS",WHATSAPP:"WHATSAPP"},b=((i={})[y.CHAT]="CHAT",i[y.CALL]="CALL",i[y.VIDEO]="VIDEO",i[y.MESSENGER]="CHAT",i[y.SMS]="SMS",i[y.WHATSAPP]="CHAT",i),I={DISABLED:"DISABLED",SINGLE:"SINGLE",ICON:"ICON",MULTIPLE:"MULTIPLE",FULL_IMAGE:"FULL_IMAGE"},E={FAMILY1:"FAMILY1",FAMILY2:"FAMILY2",FAMILY3:"FAMILY3",FAMILY4:"FAMILY4",FAMILY5:"FAMILY5",FAMILY6:"FAMILY6"},T={MOBILE:"MOBILE",DESKTOP:"DESKTOP"},m=Object.freeze({__proto__:null,TEMPLATED_NOTIFICATION_POSITIONS:l,SIMPLE_TEMPLATED_NOTIFICATION_POSITIONS:f,TEMPLATED_NOTIFICATION_BORDER_RADIUS_DEFAULT_VALUE:5,TEMPLATED_NOTIFICATION_FONTS_CSS:s,TEMPLATED_NOTIFICATION_TYPES:d,TEMPLATED_MOBILE_NOTIFICATION_TYPES:p,DEFAULT_FONT:v,OFFSET_MAX:400,OFFSET_MAX_MOBILE:400,DEFAULT_COLOR:"#1bc74e",DEFAULT_TEXT_COLOR:"#FFFFFF",MESSENGER_STYLE:g,WHATSAPP_STYLE:h,DEFAULT_FONT_SIZE_RATIO:100,LANGUAGE_CODES:O,CHANNELS:y,CHANNELS_ICONS_MAPPING:b,AVATAR_TYPES:I,ICONS:E,MEDIA_TYPES:T});t.AVATAR_TYPES=I,t.CHANNELS=y,t.CHANNELS_ICONS_MAPPING=b,t.DEFAULT_COLOR="#1bc74e",t.DEFAULT_FONT=v,t.DEFAULT_FONT_SIZE_RATIO=100,t.DEFAULT_TEXT_COLOR="#FFFFFF",t.ICONS=E,t.LANGUAGE_CODES=O,t.MEDIA_TYPES=T,t.MESSENGER_STYLE=g,t.OFFSET_MAX=400,t.OFFSET_MAX_MOBILE=400,t.SIMPLE_TEMPLATED_NOTIFICATION_POSITIONS=f,t.TEMPLATED_MOBILE_NOTIFICATION_TYPES=p,t.TEMPLATED_NOTIFICATION_BORDER_RADIUS_DEFAULT_VALUE=5,t.TEMPLATED_NOTIFICATION_FONTS_CSS=s,t.TEMPLATED_NOTIFICATION_POSITIONS=l,t.TEMPLATED_NOTIFICATION_TYPES=d,t.WHATSAPP_STYLE=h,t.internalConstants=m},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object.keys(e).reduce((function(n,i){var a;return t.includes(i)?n:r(r({},n),((a={})[i]=e[i],a))}),{})}},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"CONSENTED",(function(){return r})),n.d(t,"DID_NOT_CONSENT",(function(){return i})),n.d(t,"CONSENT_NOT_AVAILABLE",(function(){return a}));var r="CONSENTED",i="DID_NOT_CONSENT",a="CONSENT_NOT_AVAILABLE"},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.deleteAllCustomData=t.getAllCustomData=t.getCustomData=t.deleteCustomData=t.setCustomData=void 0;var i=r(n(64)),a=n(56),o=(0,a.getIdz)().vStats={customData:function(){var e={};for(var t in this)null!==this[t]&&"function"!=typeof this[t]&&-1!==t.indexOf("ext_")&&(e[t.substr(4).replace(/_/g," ")]=this[t]);return JSON.stringify(e)},getProfile:function(){var e={};for(var t in this)null!==this[t]&&"function"!=typeof this[t]&&-1===t.indexOf("ext_")&&("navTime"===t&&(this[t]=1e3*Math.round(+new Date/1e3-this.connectionTime),this[t]<0&&(this[t]=3e3)),e[t]=this[t]);return JSON.stringify(e)}};t.setCustomData=function(e,t){o["ext_"+e]=t};var u=function(e){delete o["ext_"+e]};t.deleteCustomData=u;t.getCustomData=function(e){return o["ext_"+e]};var c=function(){return(0,i.default)((function(e){return Object.entries(e)}),(function(e){return e.filter((function(e){return e[0].startsWith("ext_")}))}),(function(e){return e.map((function(e){var t=e[0],n=e[1];return[t.substr("ext_".length),n]}))}),(function(e){return Object.fromEntries(e)}))(o)};t.getAllCustomData=c;t.deleteAllCustomData=function(){Object.keys(c()).forEach(u)};var l=o;t.default=l},function(e,t,n){"use strict";n.r(t);t.default={set:function(e,t){try{window.sessionStorage.setItem(e,JSON.stringify(t))}catch(e){}},get:function(e){return function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}}(window.sessionStorage.getItem(e))},remove:function(e){window.sessionStorage.removeItem(e)},clear:function(){window.sessionStorage.clear()},keys:function(){return Object.keys(window.sessionStorage)}}},function(e,t,n){"use strict";n.r(t);t.default={BOTTOM_CORNER:"bottomCorner",MODAL:"modal"}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.prefetchBotScenario=void 0;var r=n(56),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var u=i?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(r,o,u):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(62));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.prefetchBotScenario=function(e,t,n){var a=(0,r.getIdz)(),o=(0,r.getPlatform)(),u="routingRuleId="+e+"&websiteId="+(o+"-"+t)+"&lang="+n+"&platform="+o,c=a.services["conversations-bot-service"]+"scenarios/_prefetch?"+u;return i.ajaxGet({url:c,timeout:+a.engagement.prefetchBot.timeout})}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"deviceTypeToMediaType",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"fetchAndRetry",{enumerable:!0,get:function(){return a.fetchAndRetry}}),t.makeIframeId=void 0;var i=r(n(92)),a=n(107);t.makeIframeId=function(e){return"iframe-notification-"+e.id}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(74),i=n(106),a=function(e){switch(e){case i.DEVICE_TYPE.MOBILE:case i.DEVICE_TYPE.TABLET:return r.MEDIA_TYPES.MOBILE;case i.DEVICE_TYPE.DESKTOP:default:return r.MEDIA_TYPES.DESKTOP}};t.default=a},function(e,t,n){"use strict";n.r(t);t.default="GenericAction"},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},i=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};function a(e,t){var n=!1;return function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(!n){var u=e.apply(void 0,i([],r(a)));return n=!0,window.setTimeout((function(){n=!1}),t),u}}}},,,,,,function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.OPERATORS=void 0;var r=function(e){return null==e},i={is:"is",notIs:"notIs",contains:"contains",notContains:"notContains",endsWith:"endsWith",beginsWith:"beginsWith",regex:"regex",notRegex:"notRegex",equal:"equal",lowerThan:"lowerThan",greaterThan:"greaterThan",lowerOrEqualThan:"lowerOrEqualThan",greaterOrEqualThan:"greaterOrEqualThan"};t.OPERATORS=i;var a=((n={})[i.is]=function(e,t){return!r(e)&&e==t},n[i.notIs]=function(e,t){return!a[i.is](e,t)},n[i.contains]=function(e,t){return!r(e)&&-1!==e.indexOf(t)},n[i.notContains]=function(e,t){return!a[i.contains](e,t)},n[i.endsWith]=function(e,t){return void 0===e&&(e=""),e.endsWith(t)},n[i.beginsWith]=function(e,t){return void 0===e&&(e=""),e.startsWith(t)},n[i.regex]=function(e,t){try{return new RegExp(t).test(e)}catch(e){return!1}},n[i.notRegex]=function(e,t){try{return!new RegExp(t).test(e)}catch(e){return!1}},n[i.equal]=function(e,t){return!r(e)&&e==t},n[i.lowerThan]=function(e,t){return!r(e)&&e<t},n[i.greaterThan]=function(e,t){return!r(e)&&e>t},n[i.lowerOrEqualThan]=function(e,t){return!r(e)&&e<=t},n[i.greaterOrEqualThan]=function(e,t){return!r(e)&&e>=t},n),o=a;t.default=o},function(e,t,n){"use strict";n.r(t),n.d(t,"incrementNotificationCappingIfNecessary",(function(){return u})),n.d(t,"isNotificationDisplayCapped",(function(){return c}));var r=n(88),i=n(56),a="iadvize.engagement.notification-display-capping",o=function(){return"iadvize-"+Object(i.getWebsiteId)()+"-notification-capping"};function u(){var e=Object(i.getIdz)().featureFlags[a];if(e&&-1!==e){var t=r.default.get(o()),n=parseInt(t||0,10)+1;r.default.set(o(),n)}}function c(){var e=Object(i.getIdz)().featureFlags[a],t=r.default.get(o())||0;return!(!e||-1===e)&&t>=e}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.isFixedButton=void 0;var i=r(n(71)),a=r(n(10)),o=n(56),u=A(n(62)),c=r(n(7)),l=r(n(78)),f=r(n(79)),s=n(170),d=A(n(80)),p=n(122),v=n(103),g=n(104),h=n(105),O=n(91),y=r(n(121)),b=r(n(2)),I=r(n(1)),E=r(n(82)),T=r(n(63)),m=r(n(108));function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(S=function(e){return e?n:t})(e)}function A(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=S(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}var C=c.default.EngagementNotificationClicked,_=c.default.EngagementShowChatboxWithPrefetchedScenarioFailed,w=c.default.EngagementShowChatboxWithPrefetchedScenario,P=function(e){return"templated_notification"===e.type&&"FIXED"===e.parameters.type};t.isFixedButton=P;t.default=function(){var e=(0,o.getIdz)(),t=(0,o.getEventManager)(),n=(0,d.default)(e),r=(0,d.isPrefetchableRuleFactory)(e),c={chat:function(e){return t.emit(b.default.showChatboxButtonClickedBeforeBundle,(0,E.default)(e,"offsiteProfileExternalId"))},call:function(e){return t.emit(b.default.showCallButtonClickedBeforeBundle,(0,E.default)(e,"offsiteProfileExternalId"))},video:function(e){return t.emit(I.default.OnConversationVisioRequestedBeforeBundle,(0,E.default)(e,"offsiteProfileExternalId"))},visio:function(e){return t.emit(I.default.OnConversationVisioRequestedBeforeBundle,(0,E.default)(e,"offsiteProfileExternalId"))},messenger:function(e){var t=e.offsiteProfileExternalId;return(0,v.redirectToMessenger)(t)},sms:function(e){var t=e.offsiteProfileExternalId;return(0,g.redirectToSMS)(t)},whatsapp:function(e){var t=e.offsiteProfileExternalId;return(0,h.redirectToWhatsapp)(t)}},S=function(e,t){if(!e)return null;var n=document.querySelector(e);return n?t(n):null},A=function(a){function o(e){var t;(t=a.call(this,e)||this).notification=(0,p.getNotificationById)(t.notificationId);var n=t.parameters.button.channel.toLowerCase();return t.selectors=t.notification.templateAttributes,t.channel=(0,f.default)(n),t.onClickForChannel=(0,m.default)(c,n,T.default),t.id=t.notificationId,t.offsiteProfileExternalId=t.parameters.button.offsiteProfileExternalId,t}(0,i.default)(o,a);var l=o.prototype;return l.isAvailable=function(e){return this.channel.isAvailable(e)},l.shouldExecute=function(){return!0},l.shouldCancel=function(){return!1},l.execute=function(i,o,c){var l=this,f=this.isExecuted(),d=!1;a.prototype.execute.call(this),(0,s.loadCustomizedTemplate)();var p=this.selectors;f||(this.selectorsInitialStyle={online:S(this.selectors.onlineCssSelector,(function(e){return e.style.cssText})),busy:S(this.selectors.busyCssSelector,(function(e){return e.style.cssText})),offline:S(this.selectors.offlineCssSelector,(function(e){return e.style.cssText}))}),u.hide(p.onlineCssSelector),u.hide(p.busyCssSelector),u.hide(p.offlineCssSelector),f||(this.onClick=function(){if(!d){d=!0,t.emit(C,{action:l});var i=!(!c||!r(o,c));a.prototype.doSideEffectsOnClick.call(l,o),l.onClickForChannel({vuid:e.vuid,id:l.id,ruleId:o,routingRuleId:c,isPrefetchCase:i,offsiteProfileExternalId:l.offsiteProfileExternalId}),i&&(0,O.fetchAndRetry)((function(){return n(o,c)}),1,50).then((function(n){var r=n.data,i={routingRuleId:c,ruleId:o,messages:r,vuid:e.vuid};t.emit(w,i)}),(function(){var n={routingRuleId:c,ruleId:o,vuid:e.vuid};t.emit(_,n)}))}return!1},u.on(p.onlineCssSelector,"click",this.onClick)),this.isAvailable(i)?u.show(p.onlineCssSelector):this.channel.isBusy(i)?u.show(p.busyCssSelector):u.show(p.offlineCssSelector);var v,g="VIDEO"===(v=this.parameters.button).channel?"visio":v.channel.toLowerCase();(0,y.default)(t).computeAvailabilityAndDispatchDisplay(i,[g])},l.cancel=function(){a.prototype.cancel.call(this);var e=this.selectors,t=this.selectorsInitialStyle;S(this.selectors.onlineCssSelector,(function(e){e.style.cssText=t.online})),S(this.selectors.busyCssSelector,(function(e){e.style.cssText=t.busy})),S(this.selectors.offlineCssSelector,(function(e){e.style.cssText=t.offline})),u.off(e.onlineCssSelector,"click",this.onClick)},o}(l.default);return(0,a.default)(A,"canHandle",P),A.prototype.visible=!0,A}},function(e,t,n){"use strict";n.r(t),n.d(t,"redirectToMessenger",(function(){return r}));var r=function(e){window.open("http://m.me/"+e,"_blank")}},function(e,t,n){"use strict";n.r(t),n.d(t,"redirectToSMS",(function(){return r}));var r=function(e){window.open("sms:"+e,"_blank")}},function(e,t,n){"use strict";n.r(t),n.d(t,"redirectToWhatsapp",(function(){return r}));var r=function(e){window.open("http://wa.me/"+e,"_blank")}},,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAndRetry=void 0;t.fetchAndRetry=function e(t,n,r){return t().catch((function(i){if(n<=1)throw i;return(a=r,new Promise((function(e){return setTimeout(e,a)}))).then((function(){return e(t,n-1,2*r)}));var a}))}},function(e,t,n){"use strict";function r(e,t,n){return e&&e[t]?e[t]:n}n.r(t),n.d(t,"default",(function(){return r}))},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(57)),a="VALID",o="CANCELED";t.default=function(e){void 0===e&&(e=1e3);var t=function(){function t(){this.state=a}return t.prototype.wrapInWaitingActiveTabCancelable=function(t){var n=this;return function(){for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return new i.default((function(r,u){!function c(){if(n.state===o)r();else if(document.visibilityState&&"hidden"===document.visibilityState)setTimeout(c,e);else{var l=t.apply(void 0,a);l instanceof i.default?l.then(r,u):r(l)}}()}))}},t}(),n=new t;return{wrapInWaitingActiveTabCancelable:function(e){return n.wrapInWaitingActiveTabCancelable(e)},cancelAll:function(){n.state=o,n=new t}}}},function(e,t,n){"use strict";function r(e,t){var n=[[],[]];return e.forEach((function(e){var r=t(e)?0:1;n[r].push(e)})),n}n.r(t),n.d(t,"default",(function(){return r}))},function(e,t,n){"use strict";n.r(t),n.d(t,"HIDDEN",(function(){return r})),n.d(t,"OPENED",(function(){return i})),n.d(t,"MINIMIZED",(function(){return a})),n.d(t,"CHATBAR_HIDDEN",(function(){return o}));var r=1,i=2,a=3,o=4},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.timeoutPromise=t.promisifyFn=void 0;var i=r(n(57));t.promisifyFn=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return new i.default((function(t){return e.apply(void 0,n.concat([t]))}))}};t.timeoutPromise=function(e,t){return i.default.race([e,new i.default((function(e,n){return setTimeout((function(){return n(new Error("Promise timed out"))}),t)}))])}},,,,,,function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(87)),a=r(n(100)),o=function(){function e(e){var t=this;Object.keys(e).forEach((function(n){t[n]=e[n]}))}var t=e.prototype;return t.sanitizeValue=function(e){return null==e?e:(""+e).toLowerCase()},t.getValue=function(){return this.sanitizeValue(i.default[this.criteria.field])},t.getTestValue=function(){return this.sanitizeValue(this.value)},t.isMet=function(){var e=a.default[this.logicalOperator];if(!e)throw new Error("The operator "+this.logicalOperator+" isn't recognized");return e(this.getValue(),this.getTestValue())},t.getBaseType=function(){},e}();t.default=o},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ActivityCondition=t.TimeCondition=t.StringCondition=t.FloatCondition=t.IntegerCondition=t.BooleanCondition=void 0;var i=r(n(71)),a=n(56),o=r(n(7)),u=r(n(87)),c=r(n(118)),l=n(100),f=function(e){function t(){return e.apply(this,arguments)||this}(0,i.default)(t,e);var n=t.prototype;return n.getBaseType=function(){return"BOOL"},n.sanitizeValue=function(e){return"string"==typeof e?"true"===e||"1"===e:!!e},t}(c.default);t.BooleanCondition=f;var s=function(e){function t(){return e.apply(this,arguments)||this}(0,i.default)(t,e);var n=t.prototype;return n.getBaseType=function(){return"INTEGER"},n.sanitizeValue=function(e){return null==e?e:parseInt(e,10)},t}(c.default);t.IntegerCondition=s;var d=function(e){function t(){return e.apply(this,arguments)||this}(0,i.default)(t,e);var n=t.prototype;return n.getBaseType=function(){return"FLOAT"},n.sanitizeValue=function(e){return null==e?e:parseFloat(e)},t}(c.default);t.FloatCondition=d;var p=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.default)(t,e),t.prototype.getBaseType=function(){return"STRING"},t}(c.default);t.StringCondition=p;var v=function(e){function t(t){var n;return(n=e.call(this,t)||this).logicalOperator!==l.OPERATORS.equal&&n.logicalOperator!==l.OPERATORS.greaterThan||(n.logicalOperator=l.OPERATORS.greaterOrEqualThan),n}(0,i.default)(t,e);var n=t.prototype;return n.getBaseType=function(){return"INTEGER"},n.getValue=function(){var t=Math.round(60*e.prototype.getTestValue.call(this));return(new Date).getTime()-1e3*t},n.getTestValue=function(){return e.prototype.getValue.call(this)},t}(d);t.TimeCondition=v;var g=function(e){function t(t){var n;(n=e.call(this,t)||this)._timeOut=null;var r=n.criteria.field;return n.value*=60,u.default[r]=u.default[r]||0,n}(0,i.default)(t,e);var n=t.prototype;return n.tRefreshData=function(){var e=new Date,t=Math.ceil((e.getTime()-u.default.lastMove)/1e3);u.default.activeSince=t>5?u.default.activeSince:e.getTime(),u.default[this.criteria.field]=Math.ceil((e.getTime()-u.default.activeSince)/1e3)},n.tIsFalse=function(e){var t=1e3+1e3*(this.value-u.default[this.criteria.field]);this.logicalOperator===l.OPERATORS.equal&&(this.logicalOperator=l.OPERATORS.greaterOrEqualThan),this.logicalOperator===l.OPERATORS.lowerThan&&(t-=2e3),clearTimeout(this._timeOut),this._timeOut=setTimeout((function(){(0,a.getEventManager)().emit(o.default.TargetingRuleRun,e)}),Math.abs(t))},t}(d);t.ActivityCondition=g;var h={BOOL:f,INTEGER:s,FLOAT:d,STRING:p,TIME:v,ACTIVITY:g,HTML:p,IHTML:s,FHTML:d,COUNTRY:p,TOWN:p,REFERRER:p,LANG:p,DAY:s,HOUR:s,DEVICE:p};t.default=h},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(10)),a=r(n(71)),o=n(56),u=r(n(89)),c=r(n(78)),l=r(n(79)),f=r(n(121)),s=n(122),d=r(n(25)),p=r(n(7)),v=r(n(64));function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(){var e=(0,o.getEventManager)(),t=function(e){return"VIDEO"===e.channel?"visio":e.channel.toLowerCase()},n=function(e){return(0,v.default)(t,l.default,(function(t){return t.isAvailable(e)}))},r=(0,f.default)(e),i=function(i){function o(e){var t;return(t=i.call(this,e)||this).notification=(0,s.getNotificationById)(t.notificationId),t}(0,a.default)(o,i);var c=o.prototype;return c.isAvailable=function(e){return(this.parameters.buttons||[this.parameters.button]).filter(n(e)).length>0},c.shouldExecute=function(e){return this.isAvailable(e)&&!this.isCapped()},o.canHandle=function(e){return"templated_notification"===e.type&&"FIXED"!==e.parameters.type&&"INVITATION"!==e.parameters.type},c.getContainerId=function(){return u.default.BOTTOM_CORNER},c.execute=function(a,o,u){var c=this;i.prototype.execute.call(this);var l=this;d.default.getNotificationOrchestrator().then((function(e){var i=e.actions,f=e.store;c.store=f,c.actions=i,f.dispatch(i.showNotification(h(h({},l),{},{parameters:h(h({},l.parameters),{},{buttons:l.parameters.buttons?l.parameters.buttons.filter(n(a)):void 0})}),o,u));var s=l.parameters.buttons.map(t);r.computeAvailabilityAndDispatchDisplay(a,s)})).catch((function(){e.emit(p.default.tagOrchestratorStop)}))},c.cancel=function(){i.prototype.cancel.call(this);this.store&&this.store.dispatch(this.actions.cancelNotification(h({},this)))},o}(c.default);return i.prototype.visible=!0,i}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(10)),a=r(n(79)),o=r(n(7));function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){return{computeAvailabilityAndDispatchDisplay:function(e,t){var n=t.reduce((function(t,n){var r;return c(c({},t),{},((r={})[n]=(0,a.default)(n).isAvailable(e),r))}),{});return this.dispatchDisplay(n),n},dispatchDisplay:function(t){t.chat&&e.emit(o.default.chatButtonDisplayed),t.call&&e.emit(o.default.callButtonDisplayed),t.visio&&e.emit(o.default.videoButtonDisplayed)}}};t.default=l},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getNotificationById=void 0;var r=n(56);t.getNotificationById=function(e){return(0,r.getIdz)().proactifData.notifications[e]}},function(e,t,n){"use strict";function r(e,t){return e.reduce((function(e,n){var r="function"==typeof t?t(n):n[t];return e.hasOwnProperty(r)||(e[r]=[]),e[r].push(n),e}),{})}n.r(t),n.d(t,"default",(function(){return r}))},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.areRuleConditionsMet=t.isRuleConditionMet=void 0;var i=r(n(64)),a=r(n(173)),o=function(e,t){if(void 0!==e.getValue()){if(e.tRefreshData instanceof Function&&e.tRefreshData(),e.isMet())return!0;e.tIsFalse instanceof Function&&e.tIsFalse(t)}return!1};t.isRuleConditionMet=o;t.areRuleConditionsMet=function(e){return(0,i.default)((function(e){return e.filter((function(e){return e.criteria}))}),(function(t){return t.map((function(t){return o(t,e.id)}))}),(function(e){return e.every(a.default)}))(e.conditions)}},function(e,t,n){"use strict";n.r(t);var r=n(57),i=n.n(r);t.default=function(){var e=i.a.resolve();return{queueNext:function(t){return e=e.then(t)}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.inSiteAggregationTypes=t.inSiteTypes=t.primitiveTypes=void 0;t.primitiveTypes={STRING:"STRING",INTEGER:"INTEGER",FLOAT:"FLOAT",BOOL:"BOOL"};t.inSiteTypes={STRING:"HTML",INTEGER:"IHTML",FLOAT:"FHTML"};t.inSiteAggregationTypes={CURRENT:"current",PREVIOUS_PAGE:"prev",MIN:"min",MAX:"max",COUNT:"count"}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.getInSite=t.getAll=void 0;var i=r(n(10)),a=r(n(82)),o=n(56),u=n(126);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(){return(0,o.getIdz)().customDataConfig.map((function(e){return l(l({},(0,a.default)(e,"visible_in_desk")),{},{isVisibleInDesk:"1"===e.visible_in_desk})}))};t.getAll=f;t.getInSite=function(){return f().filter((function(e){return Object.values(u.inSiteTypes).includes(e.type)}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(22)),a=r(n(23)),o=r(n(57)),u=r(n(20)),c=n(56),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=I(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(86)),f=r(n(160)),s=r(n(171)),d=r(n(125)),p=r(n(186)),v=r(n(188)),g=r(n(189)),h=n(5),O=r(n(7)),y=r(n(1)),b=r(n(63));function I(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(I=function(e){return e?n:t})(e)}var E=O.default.EngagementNotificationClicked,T=O.default.TargetingPauseAndHide,m=O.default.TargetingRuleRun,S=O.default.VisitorIdentityChangeStart,A=O.default.VisitorInSiteCustomDataChanged,C=O.default.VisitorNavigated,_=O.default.VisitorNavigateStart;function w(){return!/(ip-label|WatchMouse)/.test(navigator.userAgent)}var P={interaction:{type:"_interaction",items:[],length:0},qualification:{type:"_qualification",items:[],length:0}};function M(e,t){void 0===t&&(t=20);for(var n=[],r=0;r<e.length;r+=t){var i=e.slice(r,r+t);n.push(i)}return n}function D(){var e=(0,c.getIdz)(),t=(0,c.getEventManager)();(0,h.startPerformanceMeasure)(h.PerformanceMarks.TARGETING_PARSE_RULES);var n=e.proactifData,r=n.interactionRules,i=n.qualificationRules;P.interaction.length=r.length,P.qualification.length=i.length;var a=M(r),o=M(i);a.forEach((function(e){(0,u.default)((function(){t.emit(O.default.targetingRuleChunkAdded,{type:P.interaction.type,content:e.map((function(e){return new f.default(e)}))})}))()})),o.forEach((function(e){(0,u.default)((function(){t.emit(O.default.targetingRuleChunkAdded,{type:P.qualification.type,content:e.map((function(e){return new f.default(e)}))})}))()}))}t.default=function(e,t,n){!function(){var e=(0,c.getEventManager)();e.on(O.default.targetingRuleChunkAdded,(function(t){var n=P.interaction.items,r=P.qualification.items;if(t.content.forEach((function(e){t.type===P.interaction.type&&n.push(e),t.type===P.qualification.type&&r.push(e)})),P.interaction.length===n.length&&P.qualification.length===r.length){(0,h.endPerformanceMeasure)(h.PerformanceMarks.TARGETING_PARSE_RULES);var i=[].concat(r,n);e.emit(O.default.targetingRulesCreated,{interactionRules:n,qualificationRules:r,targetingRules:i})}}))}();var r=b.default,f=function(){r=n.scheduleNextJwtIdentityRefreshIfNeeded()},I=(0,c.getIdz)().vuid;(0,u.default)(D)();var M=(0,p.default)(e,n.saveConversationCustomData);return(0,c.getEventManager)().on(O.default.targetingRulesCreated,(function(e){var l=e.interactionRules,p=e.qualificationRules,P=e.targetingRules;(0,u.default)((function(){!function(e){var t=e.cancelAuthenticationRefresh,n=e.clearCallbacksState,r=e.conversationEngine,l=e.interactionRules,f=e.originalVuid,p=e.qualificationRules,I=e.scheduleNextJwtIdentityRefreshIfNeeded,P=e.targetingRules,M=e.visitorService,D=(0,c.getEventManager)(),R=(0,s.default)(D,M,l,p),j=function(){return r.hasContactOngoing()},N=function(){return!(w()&&!j())||R.startOrUnpause()};D.on(m,(function(e){return!w()||R.run(e)})),D.on(T,R.pauseAndHide),D.on(A,(function(){(0,h.startPerformanceMeasure)(h.PerformanceMarks.TARGETING_RUNNER),R.run(),(0,h.endPerformanceMeasure)(h.PerformanceMarks.TARGETING_RUNNER)})),D.on(E,R.pauseAndHide);var L=(0,d.default)();D.on(_,(function(e){L.queueNext((function(){return t(),D.emit(O.default.tagLivechatStop),D.emit(O.default.tagOrchestratorStop),R.stop().then((function(){return M.loadAuthentication().catch(b.default)})).then((function(){return M.maintainVisitorState()})).then((function(){return M.updateVisitorStateToScreenChange(e)})).then((function(){D.emit(C,e),n()})).then((function(){return N()})).then((function(){return D.emit(O.default.tagOrchestratorStart)})).then((function(){return D.emit(O.default.tagLivechatStart)})).then(I)}))})),D.on(y.default.reloadTag,(function(){var e,t=(0,c.getIdz)();t.logout(),D.emit(_,(null==(e=t.vStats)?void 0:e.actualScreen)||"")})),D.on(S,(function(e){L.queueNext((function(){return"error"===e.cause?R.stop().then((function(){return M.loadFetchedAuthentication(e)})):(D.emit(O.default.tagLivechatStop),D.emit(O.default.tagOrchestratorStop),R.stop().then((function(){return M.loadFetchedAuthentication(e)})).then((function(){return M.maintainVisitorState(!0)})).then((function(){return M.updateVisitorStateToScreenChange()})).then((function(){return n()})).then((function(){return N()})).then((function(){return D.emit(O.default.tagOrchestratorStart)})).then((function(){return D.emit(O.default.tagLivechatStart)})).then(I))}))})),(0,u.default)((0,a.default)(i.default.mark((function e(){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,c.getIdz)(),r=(0,v.default)(n,D),e.next=4,M.loadAuthentication().catch(b.default).then((function(){return n.vuid!==f?M.maintainVisitorState(!0):o.default.resolve()}));case 4:(0,g.default)(P,N,R.fireRule),n.navigate=r.navigate,n.login=function(e){M.fireLogin(e)},n.logout=function(){t(),M.fireLogout()},r.startUrlWatcher(),D.emit(O.default.targetingLoaded,{getIsContactOngoing:j,startOrUnpauseRunnerIfNoContactOngoing:N}),(0,h.endPerformanceMeasure)(h.PerformanceMarks.TARGETING_LOAD);case 11:case"end":return e.stop()}}),e)}))))()}({cancelAuthenticationRefresh:r,clearCallbacksState:t,conversationEngine:M,interactionRules:l,originalVuid:I,qualificationRules:p,scheduleNextJwtIdentityRefreshIfNeeded:f,targetingRules:P,visitorService:n})}))()})),{constants:l}}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(10)),a=r(n(161)),o=r(n(163)),u=r(n(64)),c=r(n(123));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s=function(){function e(e){var t=this;Object.keys(e).forEach((function(n){t[n]=e[n]})),"both"===e.channel&&(this.channel="all"),this.conditions=e.targetingConditions.map((function(e){var t=e.criteria,n=e.isVisitorAttribute;return t&&n&&(t.field="ext_"+t.field),(0,a.default)(f(f({},e),{},{criteria:t}))})),e.targetingActions&&(this.actions=e.targetingActions.map((function(t){if(!t.id)switch(t.type){case"chatbox":t.id=e.id+"-chatbox";break;case"message":t.id=e.id+"-"+function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}(t.data.text);break;default:t.id=t.data.id}return(0,o.default)(t)})).filter((function(e){return!!e})))}var t=e.prototype;return t.hasActionRequiringDisplay=function(e){var t;return null==(t=this.actions)?void 0:t.some((function(t){return t.canBeDisplayed(e)}))},t.shouldIncrementDisplayCount=function(e){return(0,u.default)((function(e){return(0,c.default)(e,"type")}),(function(e){return Object.values(e).map((function(e){return null==e?void 0:e[0]}))}),(function(t){return null==t?void 0:t.some((function(t){return t.canBeDisplayed(e)&&!t.isCapped()}))}))(this.actions)},t.shouldIncrementMissedDisplayCount=function(e){var t;return!this.hasActionRequiringDisplay(e)&&(null==(t=this.actions)?void 0:t.some((function(e){return e.isVisible()&&!e.isCapped()})))},t.shouldIncrementExecutionCount=function(){var e;return null==(e=this.actions)?void 0:e.some((function(e){return e.shouldIncrementExecutionCount()}))},t.shouldIncrementCappedDisplayCount=function(e){var t;return!this.hasActionRequiringDisplay(e)&&(null==(t=this.actions)?void 0:t.some((function(e){return e.isCapped()})))},e}();t.default=s},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.criteria||{},n=t.type;t.valueType&&"count"===t.valueType&&(n="INTEGER");return new(a.default[n]||i.default)(e)};var i=r(n(118)),a=r(n(119))},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,n(t,r)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(4)(n(164));e.exports=function(e){var t=(0,r.default)(),n=null==t?void 0:t.find((function(t){return t.canHandle(e)}));return n?new n(e):(console.warn("Unknown targeting rule action type "+e.type),null)}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(165)),a=r(n(120)),o=r(n(167)),u=r(n(168)),c=r(n(169)),l=r(n(102));t.default=function(){var e=(0,i.default)();return[e.IncreaseVisitorAttributeAction,e.DecreaseVisitorAttributeAction,e.ModifyVisitorAttributeAction,(0,a.default)(),(0,o.default)(),(0,u.default)(),(0,c.default)(),(0,l.default)()]}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(71)),a=n(56),o=r(n(78));t.default=function(){var e=(0,a.getIdz)().require("visitorService"),t=function(t){function n(){return t.apply(this,arguments)||this}return(0,i.default)(n,t),n.prototype.execute=function(){t.prototype.execute.call(this);var n=this.data.visitorAttribute;if(n){var r=n.field,i=e.getCustomData(r),a=void 0!==i?+i:0,o=this.visitorAttributeModifier(a,this.data.value);e.setAndSaveCustomData(r,o)}},n}(o.default);return{IncreaseVisitorAttributeAction:function(e){function t(){return e.apply(this,arguments)||this}return(0,i.default)(t,e),t.canHandle=function(e){return"increase_visitor_attribute"===e.type},t.prototype.visitorAttributeModifier=function(e,t){return e+ +t},t}(t),DecreaseVisitorAttributeAction:function(e){function t(){return e.apply(this,arguments)||this}return(0,i.default)(t,e),t.canHandle=function(e){return"decrease_visitor_attribute"===e.type},t.prototype.visitorAttributeModifier=function(e,t){return e-+t},t}(t),ModifyVisitorAttributeAction:function(e){function t(){return e.apply(this,arguments)||this}return(0,i.default)(t,e),t.canHandle=function(e){return"modify_visitor_attribute"===e.type},t.prototype.visitorAttributeModifier=function(e,t){return t},t}(t)}}},function(e,t,n){"use strict";e.exports={isSupported:function(){var e=function(){var e=window.navigator;if(void 0!==e&&"string"==typeof e.userAgent){if(/Chrome|CriOS/.test(e.userAgent))return"chrome";if(/Firefox|FxiOS/.test(e.userAgent))return"firefox";if(/Safari/.test(e.userAgent))return"safari"}return null}();return!!e&&!function(e){var t=window.navigator,n=window.chrome;return"chrome"===e&&/Edge/.test(t.userAgent)&&(void 0===n||void 0===n.runtime)}(e)&&!function(e){return"safari"!==e&&function(e){return/(iPhone|iPod|iPad)/i.test(e.platform)}(window.navigator)}(e)&&function(){var e=window.navigator;return e.mediaDevices&&"function"==typeof e.mediaDevices.getUserMedia}()&&"function"==typeof window.RTCPeerConnection}}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(71)),a=n(56),o=r(n(89)),u=r(n(120));t.default=function(){var e=(0,a.getIdz)();return function(t){function n(){return t.apply(this,arguments)||this}(0,i.default)(n,t),n.canHandle=function(e){return"templated_notification"===e.type&&"INVITATION"===e.parameters.type};var r=n.prototype;return r.getContainerId=function(){return o.default.MODAL},r.shouldExecute=function(e){return t.prototype.shouldExecute.call(this,e)&&!this.hasBeenExecutedInSession()},r.shouldIncrementExecutionCount=function(){return!this.hasBeenExecutedInSession()},r.recordExecution=function(){var t=this.notification.id;e.flags.proactif_invit=e.flags.proactif_invit||"",e.flags.proactif_invit+=t+","},r.hasBeenExecutedInSession=function(){var t=this.notification.id;return e.flags.proactif_invit&&-1!==e.flags.proactif_invit.split(",").filter((function(e){return e})).indexOf(t.toString())},r.execute=function(n,r,i){t.prototype.execute.call(this,n,r,i);var a=this.notification.id;e.callbacks.onInvitationDisplayed({id:a})},n}((0,u.default)())}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(71)),a=n(56),o=r(n(89)),u=r(n(7)),c=r(n(78)),l=r(n(79)),f=r(n(80)),s=r(n(2));t.default=function(){var e=(0,a.getIdz)(),t=(0,a.getEventManager)(),n=(0,f.default)(e),r=function(r){function a(){return r.apply(this,arguments)||this}(0,i.default)(a,r),a.canHandle=function(e){return"chatbox"===e.type};var c=a.prototype;return c.getContainerId=function(){return o.default.BOTTOM_CORNER},c.isAvailable=function(e){return(0,l.default)("chat").isAvailable(e)},c.execute=function(i,a,o){var u=this;r.prototype.execute.call(this),this.ruleId=a,this.routingRuleId=o;var c=function(n){r.prototype.doSideEffectsOnClick.call(u,a),t.emit(s.default.showChatboxNotificationBeforeBundle,{vuid:e.vuid,actionId:u.id,ruleId:a,routingRuleId:o,prefetchedMessages:n})};n(a,o).then((function(e){var t=e.data;return c(t)})).catch((function(){return c()}))},c.cancel=function(){r.prototype.cancel.call(this),t.emit(u.default.TargetingActionChatboxCancel,{vuid:e.vuid,actionId:this.id,ruleId:this.ruleId,routingRuleId:this.routingRuleId})},a}(c.default);return r.prototype.visible=!0,r}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(71)),a=n(56),o=r(n(89)),u=r(n(7)),c=r(n(78)),l=r(n(79)),f=r(n(80)),s=r(n(2));t.default=function(){var e=(0,a.getIdz)(),t=(0,a.getEventManager)(),n=(0,f.default)(e),r=function(r){function a(){return r.apply(this,arguments)||this}(0,i.default)(a,r);var c=a.prototype;return c.isAvailable=function(e){return(0,l.default)("chat").isAvailable(e)},a.canHandle=function(e){return"message"===e.type},c.getContainerId=function(){return o.default.BOTTOM_CORNER},c.shouldExecute=function(e){return r.prototype.shouldExecute.call(this,e)&&!a.hasBeenExecutedInSession()},c.execute=function(i,a,o){var u=this;r.prototype.execute.call(this),this.ruleId=a,this.routingRuleId=o;var c=function(n){r.prototype.doSideEffectsOnClick.call(u,a),t.emit(s.default.showMessageNotificationBeforeBundle,{vuid:e.vuid,actionId:u.id,ruleId:a,routingRuleId:o,message:u.data.text,prefetchedMessages:n})};n(a,o).then((function(e){var t=e.data;return c(t)})).catch((function(){return c()}))},c.recordExecution=function(){e.flags.proactif_message=!0},a.hasBeenExecutedInSession=function(){return!!e.flags.proactif_message},c.shouldIncrementExecutionCount=function(){return!a.hasBeenExecutedInSession()},c.cancel=function(){r.prototype.cancel.call(this),t.emit(u.default.TargetingActionMessageCancel,{vuid:e.vuid,actionId:this.id,ruleId:this.ruleId,routingRuleId:this.routingRuleId})},a}(c.default);return r.prototype.visible=!0,r}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.loadCustomizedTemplate=void 0;t.loadCustomizedTemplate=function(){return iAdvize.Templates.loadChatCss()}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(172)).default;t.default=i},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(57)),a=r(n(20)),o=r(n(15)),u=r(n(7)),c=n(102),l=n(124),f=r(n(174)),s=r(n(109)),d=r(n(184)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=v(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(185));function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(v=function(e){return e?n:t})(e)}var g=u.default.TargetingEngineCheckAvailability,h=u.default.RoutingServicePollingReset,O="STOPPED",y="STARTED",b="PAUSED";function I(e){return"all"===e.channel?1:0}var E=function(e){var t;return null==(t=e.conditions)?void 0:t.some((function(e){var t;return"targeting_condition_criteria.SMART_TARGETING_SCORING"===(null==e||null==(t=e.criteria)?void 0:t.id)}))},T=(0,d.default)();t.default=function(e,t,n,r){var d,v,m=O,S=(0,s.default)(),A=(0,f.default)(),C=[].concat(r,[].concat(n).sort((d=I,function(e,t){return d(e)>d(t)?1:d(t)>d(e)?-1:0}))),_=function(){var e;(null==(e=C)?void 0:e.some(E))&&(v=t.fetchSmartScoring())},w=function(){"object"==typeof window.idzCustomData&&Object.entries(idzCustomData).forEach((function(e){var n=e[0],r=e[1];null!=r&&t.setCustomData(n,r)}))},P=function(t){(0,l.areRuleConditionsMet)(t)?(!function(e){return 1===e.actions.length&&(0,c.isFixedButton)(e.actions[0])}(t)?A.fireRule(t):T.onceVisible(t.actions[0],(function(){m===y&&A.fireRule(t)})),e.emit(u.default.targetingRuleFired)):(t.executed&&A.untriggerRule(t),p.scheduleRuleRunIfNeeded(t,(function(){return M(t.id)})))},M=function(e){if(w(),m!==y)return!0;var t=null==C?void 0:C.filter((function(t){return t.id==e}));return t.forEach(P),t},D=function(){return w(),m!==y||(C.forEach((function(e){(0,a.default)((function(){E(e)?v.then(S.wrapInWaitingActiveTabCancelable((function(){return M(e.id)}))):P(e)}))()})),C)},R=function(){return m===y?A.fireReRun():i.default.resolve()};return e.on(g,(0,o.default)(R,3e4)),_(),{fireRule:function(e){A.fireRule(e)},run:function(e){return e?M(e):D()},startOrUnpause:function(){m===O?(m=y,_(),A.untriggerQualificationRules(),A.fireEmpty(),e.emit(h),D()):m===b&&(m=y,R())},pauseAndHide:function(){m===y&&(m=b,A.hideAllNotifications())},stop:function(){var e=m;return m=O,e===y?(S.cancelAll(),T.unsubscribeAll(),p.clear(),A.cancelPending()):i.default.resolve()}}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return e}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(175));t.default=function(){return(0,i.default)()}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(5),a=n(101),o=n(56),u=r(n(7)),c=r(n(176)),l=r(n(57)),f=r(n(125)),s=r(n(109)),d=r(n(177)),p=r(n(178)),v=b(n(182)),g=b(n(183)),h=r(n(63)),O=r(n(64));function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(y=function(e){return e?n:t})(e)}function b(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=y(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}var I=u.default.TargetingRuleExecuted,E=u.default.TargetingEngineCheckAvailability,T=u.default.EngagementNotificationClose,m=u.default.EngagementNotificationClosed;function S(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=t.pop();return Array.isArray(i)?[]:[].concat(t).flat().filter((r=new Set,function(e){return!r.has(i(e))&&r.add(i(e))}))}t.default=function(e,t){void 0===e&&(e=200),void 0===t&&(t=1e3);var n=(0,o.getEventManager)(),r={qualificationRules:[],interactionRules:[]},u=(0,p.default)(),y=(0,f.default)(),b=(0,s.default)(t),A=function(){return b.wrapInWaitingActiveTabCancelable((function(e){(0,i.startPerformanceMeasure)(i.PerformanceMarks.TARGETING_RULES_BATCH);var t=r.interactionRules.filter((function(e){return e.displayed})).concat(e);return u.getRulesAvailabilities(t).then(v.getRulesOpportunities).then(g.executeInteractionRules).then((function(e){var t;void 0===e&&(e=[]),e.some((function(e){return e.displayed}))&&n.emit(E),r.interactionRules=S(r.interactionRules,e,(function(e){return null==e?void 0:e.id})),null==(t=e)||t.forEach((function(e){return n.emit(I,e)})),(0,i.endPerformanceMeasure)(i.PerformanceMarks.TARGETING_RULES_BATCH_EXECUTION),(0,i.endPerformanceMeasure)(i.PerformanceMarks.TARGETING_RULES_BATCH)}))}))},C=(0,d.default)(y,A(),e);return n.on(T,(function(e){var t=(0,O.default)((function(e){return e.map((function(e){return e.actions})).flat()}),(function(t){return null==t?void 0:t.find((function(t){return(null==t?void 0:t.id)===e}))}))(r.interactionRules);t.close(),(0,a.incrementNotificationCappingIfNecessary)(),n.emit(m,{action:t})})),{fireRule:function(e){var t;return!!(!e||null!=(t=r.interactionRules)&&t.some((function(t){return(null==t?void 0:t.id)===e.id}))||r.qualificationRules.some((function(t){return(null==t?void 0:t.id)===e.id})))||!window.document.querySelector("#idzc2c")&&(e.executed=!0,void(e.type===c.default.QUALIFICATION?(g.executeQualificationRule(e),r.qualificationRules=S(r.qualificationRules,[e],(function(e){return null==e?void 0:e.id}))):C.batch(e)))},fireEmpty:function(){return C.planBatch()},fireReRun:function(){return y.queueNext(b.wrapInWaitingActiveTabCancelable((function(){var e=r.interactionRules.filter((function(e){return e.displayed}));return 0===e.length?l.default.resolve():u.getRulesAvailabilities(e).then(g.executeInteractionRules).then((function(){return n.emit(E)}))})))},cancelPending:function(){return b.cancelAll(),C=(0,d.default)(y,A(),e),y.queueNext(h.default)},untriggerQualificationRules:function(){r.qualificationRules.forEach((function(e){var t;e.executed=!1,null==(t=e.actions)||t.forEach((function(e){return e.untrigger()}))})),r.qualificationRules=[]},untriggerRule:function(e){var t;if(e)return e.executed=!1,e.type===c.default.QUALIFICATION?r.qualificationRules=r.qualificationRules.filter((function(t){return t.id!==e.id})):(r.interactionRules=r.interactionRules.filter((function(t){return t.id!==e.id})),e.displayed=!1),null==(t=e.actions)||t.forEach((function(e){return e.untrigger()})),e},hideAllNotifications:function(){b.cancelAll();var t=y.queueNext((function(){(0,O.default)((function(e){return e.filter((function(e){return e.displayed}))}),(function(e){return e.map((function(e){return e.actions})).flat()}),(function(e){return e.filter((function(e){return e.isExecuted()&&e.isVisible()}))}),(function(e){return e.forEach((function(e){return e.cancel()}))}))(r.interactionRules)}));return C=(0,d.default)(y,A(),e),t}}}},function(e,t,n){"use strict";n.r(t);t.default={QUALIFICATION:"qualification",INTERACTION:"interaction"}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(15)),a="IDLE",o="PLANNED",u="RUNNING",c="STACKED";t.default=function(e,t,n){var r=[],l=a,f=(0,i.default)((function(){l===a?function n(){l=o,e.queueNext((function(){l=u;var e=r;return r=[],t(e).then((function(){l===u?l=a:l===c&&n()}))}))}():l===u&&(l=c)}),n);return{batch:function(e){r.push(e),f()},planBatch:f}}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(179)).default;t.default=i},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(10)),a=n(5),o=n(56),u=r(n(180));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(){var e=(0,o.getIdz)(),t=(0,u.default)();function n(t,n){return t.reduce((function(t,r){return function(t,n,r){var i={rule:n},a=null==r?void 0:r.find((function(e){return(null==e?void 0:e.id)===""+n.id}));if(a){var o=e.callInstant,u=e.callMeeting;i.availability=l(l({},a.availability),{},{callInstant:o,callMeeting:u}),"call"!==n.channel&&"all"!==n.channel&&"both"!==n.channel||(i.availability.call.available=e.call.isEnabled&&(e.callInstant.enabled&&i.availability.call.available||e.callInstant.enabled&&e.callOffline.enabled&&e.callOffline.available)),t.push(i)}return t}(t,r,n)}),[])}return{getRulesAvailabilities:function(e){return(0,a.startPerformanceMeasure)(a.PerformanceMarks.TARGETING_RULES_BATCH_FETCH_AVAILABILITY),t.checkRulesAvailability(e).then((function(t){return n(e,t)})).then((function(e){return(0,a.endPerformanceMeasure)(a.PerformanceMarks.TARGETING_RULES_BATCH_FETCH_AVAILABILITY),e}))},reduceRulesToAvailabilities:n}}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(57)),a=n(56),o=r(n(7)),u=s(n(62)),c=s(n(181)),l=r(n(64));function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function s(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}function d(e){return u.ajaxGet({url:e}).then((function(e){return e.data.map((function(e){return{id:e.id,availability:e.attributes}}))}),(function(){return[]}))}t.default=function(){var e=(0,a.getIdz)(),t=(0,a.getEventManager)(),n=e.call.isEnabled,r=!n;n&&t.on(o.default.RoutingServicePollingReset,(function(){r=!1}));return{checkRulesAvailability:function(t){if(0===t.length)return i.default.resolve([]);var n=function(e){var t=(0,a.getIdz)();return t.routing.url+"targeting-rules/available?platform="+t.platform+"&lang="+t.curlang+"&ids[]="+e.join("&ids[]=")}(t.map((function(e){return e.id})));return r?d(n):(r=!0,e.forceDep=function(e){return(0,l.default)((function(e){return e.slice().reverse()}),(function(e){return null==e?void 0:e.find((function(e){return e.skill}))}),(function(e){return e?e.skill.id:void 0}))(e)}(t),c.find().then((function(){return d(n)})))}}}},function(e,t,n){var r=n(4),i=r(n(10)),a=r(n(57));function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var u=iAdvize,c=0;t.find=function(e){void 0===e&&(e={});var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({findop:u.website_id,u:u.vuid,dep:u.forceDep,s:u.chat.status,o:0},e),r=Object.keys(n).map((function(e){return e+"="+n[e]})).join("&");return new a.default((function(n){if(document.visibilityState&&"hidden"===document.visibilityState)setTimeout((function(){t.find(e).then(n)}),1e3);else{var i=document.createElement("script"),a="idzPollingCallback"+(c+=1)+ +new Date;window[a]=function(e){u.findOpCallback(e),n(),delete window[a],i.parentNode.removeChild(i)},i.src=u.chaturl+"rpc/poll?callback="+a+"&"+r,i.onerror=function(){setTimeout((function(){t.find(e).then(n)}),1e4)},document.body.appendChild(i)}}))}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.getRulesOpportunities=function(e){(0,o.startPerformanceMeasure)(o.PerformanceMarks.TARGETING_RULES_BATCH_FETCH_OPPORTUNITY);var t=(0,u.getIdz)(),n=(0,f.default)(e,(function(e){var t=e.rule;return null==t?void 0:t.displayed})),r=n[0],c=n[1];return function(e){var t=function(e){var t=null==e?void 0:e.reduce(g,[]),n=(0,u.getIdz)();return{visitor:{id:n.vuid,websiteId:+n.website_id,sessionId:n.vStats.sessionId},qualificationRules:[],interactionRules:t}}(e),n=(0,u.getIdz)();if(0===t.interactionRules.length)return i.default.resolve([]);var r=n.targetedVisitors.url+"triggered-rules?platform="+n.platform;return l.ajaxPost({url:r,data:(0,a.JSONStringify)(t)}).then((function(e){return Object.values(e.authorizedRules)}),(function(){return[]}))}(c).then((function(e){var n=c.filter((function(n){var r=n.rule,i=n.availability,a=null==e?void 0:e.includes(r.id),o=r.hasActionRequiringDisplay(i);return!a&&o||t.callbacks.onTargetingRuleTriggered(r),o&&t.callbacks.onTargetingRuleWishToDisplay({rule:{id:r.id},vuid:t.vuid,wasExcludedByTest:!a}),!o||a}));return r.concat(n)})).then((function(e){return(0,o.endPerformanceMeasure)(o.PerformanceMarks.TARGETING_RULES_BATCH_FETCH_OPPORTUNITY),e}))};var i=r(n(57)),a=n(75),o=n(5),u=n(56),c=r(n(7)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(62)),f=r(n(110));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}var d=c.default.EngagementRuleCountExecute,p=c.default.EngagementRuleCountMissedDisplay,v=c.default.EngagementRuleCountCappedDisplay;function g(e,t){var n=t.rule,r=t.availability,i=(0,u.getEventManager)();return n.shouldIncrementExecutionCount()&&(e.push(function(e){var t=e.rule,n=e.availability;return{id:t.id,isVisibleAndAvailable:t.hasActionRequiringDisplay(n),canBeDisplayed:t.hasActionRequiringDisplay(n),shouldIncrementDisplayCount:t.shouldIncrementDisplayCount(n),shouldIncrementMissedDisplayCount:t.shouldIncrementMissedDisplayCount(n),shouldIncrementCappedDisplayCount:t.shouldIncrementCappedDisplayCount(n),availability:n}}(t)),i.emit(d,n),n.shouldIncrementMissedDisplayCount(r)&&i.emit(p,n),n.shouldIncrementCappedDisplayCount(r)&&i.emit(v,n)),e}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQualificationRule=function(e){(e.actions||[]).forEach((function(e){return e.execute()}))},t.executeInteractionRules=function(e){void 0===e&&(e=[]);(0,o.startPerformanceMeasure)(o.PerformanceMarks.TARGETING_RULES_BATCH_EXECUTION);var t=e.map((function(e){var t=e.rule,n=e.availability;return(t.actions||[]).map((function(e){return{action:e,availability:n,rule:t}}))})).flat(),n=t.filter((function(e){return e.action.isExecuted()})),r=(c=t,Object.values((0,d.default)(c,(function(e){var t=e.action;return e.rule.id+"-"+t.type}))).map((function(e){return null==e?void 0:e.find((function(e){var t=e.action,n=e.availability;return t.isExecuted()&&!t.shouldCancel(n)||t.shouldExecute(n)}))})).filter((function(e){return void 0!==e}))),i=(0,s.default)(y,b)(r);var c;return n.filter((function(e){return!i.includes(e)})).forEach((function(e){var t=e.action;!function(e,t){(0,f.isFixedButton)(e)?!e.isAvailable(t)&&e.isOnlineDisplayed&&(e.isOnlineDisplayed=!1,E(e,t)):e.isExecuted()&&E(e,t)}(t,e.availability),t.cancel()})),i.filter((function(e){var t=e.action,n=e.availability;return t.shouldExecute(n)})).forEach((function(e){var t=e.action,n=e.availability,r=e.rule;!function(e,t){var n,r=(0,u.getIdz)();r.opOffline=e.chat.available?0:1,r.c2cOffline=e.call.available||r.callMeeting&&r.callMeeting.available&&r.callMeeting.enabled?0:1,r.callInstant&&(r.callInstantAvailability=g(g({},r.callInstantAvailability),{},((n={})[t]=e.call.available,n)));r.opBusy=e.chat.busy?1:0}(n,r.id),function(e,t){(0,f.isFixedButton)(e)?e.isAvailable(t)&&!e.isOnlineDisplayed?(e.isOnlineDisplayed=!0,I(e)):!e.isAvailable(t)&&e.isOnlineDisplayed&&(e.isOnlineDisplayed=!1,E(e,t)):e.isExecuted()||I(e)}(t,n),t.execute(n,r.id,r.routingRuleId)})),Object.values((0,d.default)(r,(function(e){var t=e.rule;return null==t?void 0:t.id}))).forEach((function(e){return function(e){var t=(0,u.getIdz)();t.callbacks.onRuleStarted({id:e.id,label:e.label}),t.proactif_now=1,e.displayed=!0,(0,l.default)().saveData({proactif_message:t.util.htmlspecialchars(t.flags.proactif_message),proactif_invit:t.flags.proactif_invit,phoneDisplayed:t.flags.phoneDisplayed})}(e[0].rule)})),a.default.resolve(e.map((function(e){return e.rule})))};var i=r(n(10)),a=r(n(57)),o=n(5),u=n(56),c=r(n(7)),l=r(n(73)),f=n(102),s=r(n(64)),d=r(n(123)),p=r(n(110));function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=c.default.EngagementNotificationDisplayed,O=c.default.EngagementNotificationHidden;function y(e){var t,n=(0,p.default)(e,(function(e){return null===e.action.getContainerId()})),r=n[0],i=n[1],a=Object.values((0,d.default)(i,(function(e){return e.action.getContainerId()}))).map((function(e){return e[e.length-1]}));return t=[].concat(r,a),[].concat(t).sort().filter((function(e,t,n){return!t||e!==n[t-1]}))}function b(e){return e.filter((function(e){return!e.action.isClosed()}))}var I=function(e){return(0,u.getEventManager)().emit(h,{action:e})},E=function(e,t){var n=e.isAvailable(t)?"unknown detailed reason, but another notification with higher priority should have displayed":"lack of availability";(0,u.getEventManager)().emit(O,{action:e,cause:n})}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(63)),a=r(n(110)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(62));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}t.default=function(){if("function"!=typeof window.IntersectionObserver)return{onceVisible:function(e,t){return t()},unsubscribeAll:i.default};var e=[],t=new IntersectionObserver((function(n){var r=n.filter((function(e){return e.intersectionRatio>0})).map((function(e){return e.target}));if(r.length>0){var i=(0,a.default)(e,(function(e){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.filter((function(e){return n.every((function(t){return t.includes(e)}))}))}(e.elements,r).length>0})),o=i[0],u=i[1];e=u,o.map((function(e){return e.elements})).flat().forEach((function(e){return t.unobserve(e)})),o.forEach((function(e){return(0,e.callback)()}))}}),{threshold:0}),n=function(e){return"none"!==window.getComputedStyle(e).display};return{onceVisible:function(r,i){var a=r.selectors,u=[a.onlineCssSelector,a.busyCssSelector,a.offlineCssSelector].map(o.selectOpt).filter((function(e){return!!e}));if(u.filter(n).length>0)e=[].concat(e,[{elements:u,callback:i}]),u.forEach((function(e){return t.observe(e)}));else if(u.length>0){var c=[].concat(u,[u[0].parentNode]);e=[].concat(e,[{elements:c,callback:i}]),c.forEach((function(e){return t.observe(e)}))}},unsubscribeAll:function(){e=[],t.disconnect()}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.clear=t.scheduleRuleRunIfNeeded=void 0;var r=n(119),i=n(100),a={},o=[i.OPERATORS.greaterThan,i.OPERATORS.greaterOrEqualThan];t.scheduleRuleRunIfNeeded=function(e,t){var n,i=null==(n=e.conditions)?void 0:n.reduce((function(e,t){if(t instanceof r.TimeCondition&&null!=o&&o.includes(t.logicalOperator)){var n=t.getTestValue()-t.getValue();return Math.max(e,n)}return e}),-1);i>=0&&(a[e.id]=setTimeout((function(){t(),delete a[e.id]}),i))};t.clear=function(){Object.values(a).forEach((function(e){return clearTimeout(e)})),a={}}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,a.default)((0,i.getIdz)(),(0,i.getEventManager)(),e,t)};var i=n(56),a=r(n(187))},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){var T=function(){e.featureFlags&&!1===e.featureFlags["iadvize.engagement.run-targeting-after-chatbox-close"]||e.orchestrator.onResetChatbox((function(t){t.payload.isUserIntended&&((0,p.incrementNotificationCappingIfNecessary)(),e.ProActif.run())}))},m=function(){return e.flags.conversationId};return t.once(c.default.targetingLoaded,function(){var e=(0,a.default)(i.default.mark((function e(p){var v,h,O,y;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v=p.getIsContactOngoing,h=p.startOrUnpauseRunnerIfNoContactOngoing,O=(0,f.isChatting)()?r(m()):o.default.resolve(),(0,f.isFromMail)()&&((0,f.shouldReengage)()?n.emit(l.default,{name:"conversations.chatbox.cameBackFromEmailAndConversationFinalClosed",properties:{conversationId:(0,s.default)()}}):n.emit(l.default,{name:"conversations.chatbox.cameBackFromEmailAndConversationSnoozed",properties:{conversationId:(0,s.default)()}})),y=function(){var e=(0,a.default)(i.default.mark((function e(){var r,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:r=e.sent,a=r.orchestratorLoader,(0,d.startPerformanceMeasure)(d.PerformanceMarks.TARGETING_LOAD_ORCHESTRATOR),t.once(g.default.orchestratorModuleLoaded,T),a(E()(u.namespaces.orchestrator),n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.once(c.default.targetingRuleFired,(function(){y()})),e.next=7,O;case 7:v()?y():h();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.on(b,(function(){if((0,f.isChatting)()){var n=function(){return e.chat.sendPresence("dnd")};r(m()).then(n,n)}else t.emit(c.default.cleanupChatbox),e.Templates.hideUI()})),t.on(h,(function(n){(0,f.isChatting)()||(e.Templates.destroyDialog(),t.emit(v.default.cancelChatbox,n))})),t.on(O,(function(n){(0,f.isChatting)()||(e.Templates.destroyDialog(),t.emit(v.default.cancelMessage,n))})),t.on("conversation.chat.started",(function(){t.emit(y),r(m())})),t.on(c.default.tagOrchestratorStop,(0,a.default)(i.default.mark((function e(){var t,n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:n=e.sent,r=n.orchestratorUnloader,null==(t=iAdvize.orchestrator)||t.resetChatbox(!1),setTimeout((function(){r(E()(u.namespaces.orchestrator))}),0);case 6:case"end":return e.stop()}}),e)})))),t.on(c.default.tagOrchestratorStart,(0,a.default)(i.default.mark((function e(){var r,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:r=e.sent,a=r.orchestratorLoader,t.once(g.default.orchestratorModuleLoaded,T),a(E()(u.namespaces.orchestrator),n);case 6:case"end":return e.stop()}}),e)})))),{hasContactOngoing:function(){return e.chat&&(0,f.isChatting)()||(0,f.shouldReengage)()}}};var i=r(n(22)),a=r(n(23)),o=r(n(57)),u=n(24),c=r(n(7)),l=r(n(93)),f=n(21),s=r(n(26)),d=n(5),p=n(101),v=r(n(2)),g=r(n(1)),h=c.default.TargetingActionChatboxCancel,O=c.default.TargetingActionMessageCancel,y=c.default.TargetingPauseAndHide,b=c.default.VisitorNavigated,I=function(){return Promise.all([n.e(1),n.e(11)]).then(n.t.bind(null,295,7))},E=function(){return iAdvize.require("dispatcherWithRegistry")}},function(e,t,n){"use strict";n.r(t);var r=n(7),i=n(94);t.default=function(e,t){var n,a=document.location.href;function o(e){"string"==typeof e?t.emit(r.default.VisitorNavigateStart,e):console.warn("navigate first argument must be a string")}return{startUrlWatcher:function(t){void 0===t&&(t=500),e.featureFlags&&e.featureFlags["iadvize.engagement.targeting.disable-auto-navigate"]||function e(t){var r=document.location.href;a!==r&&(o(r),a=r),n=window.setTimeout((function(){return e(t)}),t)}(t)},stopNavigateWatcher:function(){n&&clearTimeout(n)},navigate:Object(i.default)(o,1e3)}}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(56),a=r(n(7)),o=n(124);t.default=function(e,t,n){(0,i.getIdz)().ProActif={_datas:e,run:t,fireRule:n,isRuleConditionMet:o.isRuleConditionMet,match:function(e){(0,i.getEventManager)().on(a.default.TargetingRuleExecuted,e)}}}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(56),a=r(n(191)),o=r(n(192)),u=r(n(193)),c=r(n(194)),l=r(n(73)),f=r(n(88)),s=n(5);t.default=function(){var e=(0,i.getIdz)(),t=(0,i.getEventManager)();(0,s.startPerformanceMeasure)(s.PerformanceMarks.TARGETING_LOAD),(0,a.default)(e),(0,c.default)(window,e);var n=new(e.require("dispatcherFactory"));e.findOpCallback=(0,u.default)(e,t);var r=(0,o.default)(window.iAdvizeCallbacks,t),d=r.callbacks,p=r.clearCallbacksState;return e.callbacks=d,e.Store=f.default,e.JSONStore=(0,l.default)(),{orchestratorDispatcher:n,clearCallbacksState:p}}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(10)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var u=i?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(r,a,u):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(111));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e){e.chat=c(c({},e.chat),{},{history_id:+e.flags.history_id,prev_history:+e.flags.prev_history,status:+e.flags.chat_status,satisfaction:+e.flags.satisfaction_status,CHATBOX_STATES:a})}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(10)),a=r(n(7)),o=r(n(64)),u=r(n(63)),c=r(n(16));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e,t){var n={onScriptLoaded:u.default,onInvitationDisplayed:u.default,onChatDisplayed:u.default,onChatHidden:u.default,onChatButtonDisplayed:u.default,onCallButtonDisplayed:u.default,onVideoButtonDisplayed:u.default,onChatStarted:u.default,onChatEnded:u.default,onCallStarted:u.default,onCallEnded:u.default,onStatusChanged:u.default,onCallStatusChanged:u.default,onRuleStarted:u.default,onMessageReceived:u.default,onMessageSent:u.default,onAlertReceived:u.default,onOperatorWriting:u.default,onOperatorStopWriting:u.default,onVisitorWriting:u.default,onVisitorStopWriting:u.default,onOfferReceived:u.default,onLinkReceived:u.default,onCobrowsingRequested:u.default,onCobrowsingAccepted:u.default,onCobrowsingRefused:u.default,onCobrowsingStopped:u.default,onSatisfactionDisplayed:u.default,onSatisfactionAnswered:u.default,onVisitorTransferred:u.default,onVisitorCallboxDisplayed:u.default,onTargetingRuleTriggered:u.default,onTargetingRuleWishToDisplay:u.default,retrieveAuthenticationParameters:function(e){return e({type:"ANONYMOUS"})}},r={onInvitation:"onInvitationDisplayed",onC2cStatusChanged:"onCallStatusChanged",onOperatorMsg:"onMessageReceived",onVisitorMsg:"onMessageSent"},i=["","value","values","null","nulle","undefined","nan","infinity","none"],l=(0,o.default)((function(e){return e instanceof Object?e:{}}),(function(e){return Object.entries(e)}),(function(e){return e.filter((function(e){return"function"==typeof e[1]}))}),(function(e){return e.map((function(e){var t=e[0],n=e[1];return[r[t]||t,n]}))}),(function(e){return e.filter((function(e){return e[0]in n}))}),(function(e){return Object.fromEntries(e)}))(e),s=Object.entries(l).reduce((function(e,t){var n,r,a,o=t[0],u=t[1];return f(f({},e),{},((n={})[o]="retrieveAuthenticationParameters"===o?(a=u,function(e){return a((function(t){if(-1===Object.values(c.default).indexOf(t.type))throw console.error("Authentication type not recognized"),new Error("Authentication type not recognized");if(t.type===c.default.SECURED&&("string"!=typeof t.token||""===t.token))throw console.error("token field require a String for SECURED auth"),new Error("token field require a String for SECURED auth");if(t.type===c.default.SIMPLE&&("string"!=typeof t.userId||-1!==i.indexOf(t.userId)))throw console.error("userId field require a valid String for SIMPLE auth"),new Error("userId field require a valid String for SIMPLE auth");e(t)}))}):(r=u,function(){try{r.apply(void 0,arguments)}catch(e){}}),n))}),{}),d=f(f({},n),s),p=!1;t.on(a.default.chatButtonDisplayed,(function(){p||(p=!0,d.onChatButtonDisplayed())}));var v=!1;t.on(a.default.callButtonDisplayed,(function(){v||(v=!0,d.onCallButtonDisplayed())}));var g=!1;return t.on(a.default.videoButtonDisplayed,(function(){g||(g=!0,d.onVideoButtonDisplayed())})),t.on("engagement.callBox.open",(function(){d.onVisitorCallboxDisplayed()})),{callbacks:d,clearCallbacksState:function(){p=!1,v=!1,g=!1}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e,t){return function(n){if(e.opOffline=n.opOffline,e.c2cOffline=n.c2cOffline,e.call.isEnabled&&(e.callMeeting.available=!!n.callMeeting&&n.callMeeting.available,e.callMeeting.enabled=!!n.callMeeting&&n.callMeeting.enabled,e.callInstant.available=!!n.callInstant&&n.callInstant.available,e.callInstant.enabled=!!n.callInstant&&n.callInstant.enabled,e.callOffline.available=!!n.callOffline&&n.callOffline.available,e.callOffline.enabled=!!n.callOffline&&n.callOffline.enabled),void 0!==n.opBusy&&(e.opBusy=n.opBusy),2!=e.chat.status&&(e.callbacks.onStatusChanged({offline:n.opOffline,busy:n.opBusy,c2cOffline:n.c2cOffline}),e.callbacks.onCallStatusChanged({offline:n.c2cOffline,chatOffline:n.opOffline})),1==n.opOffline&&1==e.c2cOffline)try{e.chat.status<2&&e.Templates.hideUI()}catch(e){}else if(1==n.opOffline)try{e.chat.status<2&&e.Templates.hideUI()}catch(e){}t.emit("targeting.poll.callback",n)}}},function(e,t){e.exports=function(e,t){t.util={detectDoctype:function(){return{xhtml:"",version:"",importance:"",loose:0}},load_css:function(e){var t=document.head,n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e),t.appendChild(n)},addScript:function(e,t,n){var r=new Date,i=document.getElementById(e);null!==i&&i.parentNode.removeChild(i);var a=document.head,o=document.createElement("script");o.id=e,o.type="text/javascript",o.async=!0,o.src=t+"&random="+r.getTime(),a.insertBefore(o,a.firstChild);o.onload=o.onreadystatechange=function(){this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||n&&n()}},delScript:function(e){var t=document.getElementById(e);null!==t&&t.parentNode.removeChild(t)},nl2br:function(e){return(""+e).replace(/([^>]?)(\r\n|\n\r|\n|\r)/g,"$1<br/>")},htmlspecialchars:function(e){return"string"==typeof e&&(e=(e=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/"/g,"&quot;")).replace(/'/g,"&#039;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/\\/g,"&#92;")),e},htmlSimpleEscape:function(e){return"string"==typeof e&&(e=(e=e.replace(/</g,"&lt;")).replace(/>/g,"&gt;")),e},string:{padLeft:function(e,t,n){for(var r=e;r.length<n;)r=t+r;return r}},date:{getMonthName:function(e){if(!e)return"";switch(e.getMonth()){case 0:return t.T("january");case 1:return t.T("february");case 2:return t.T("march");case 3:return t.T("april");case 4:return t.T("may");case 5:return t.T("june");case 6:return t.T("july");case 7:return t.T("august");case 8:return t.T("september");case 9:return t.T("october");case 10:return t.T("november");case 11:return t.T("december");default:return""}},getDayName:function(e){if(!e)return"";switch(e.getDay()){case 0:return t.T("sunday");case 1:return t.T("monday");case 2:return t.T("tuesday");case 3:return t.T("wednesday");case 4:return t.T("thursday");case 5:return t.T("friday");case 6:return t.T("saturday");default:return""}},formatDate:function(e,n){var r=this.getMonthName(e),i=this.getDayName(e);return n.replace(/yyyy/g,e.getFullYear()).replace(/yy/g,String(e.getFullYear()).substr(2,2)).replace(/MMM/g,r.substr(0,3).toUpperCase()).replace(/Mmm/g,r.substr(0,3)).replace(/MM\*/g,r.toUpperCase()).replace(/Mm\*/g,r).replace(/mm/g,t.util.string.padLeft(String(e.getMonth()+1),"0",2)).replace(/DDD/g,i.substr(0,3).toUpperCase()).replace(/Ddd/g,i.substr(0,3)).replace(/DD\*/g,i.toUpperCase()).replace(/Dd\*/g,i).replace(/dd/g,t.util.string.padLeft(String(e.getDate()),"0",2)).replace(/d\*/g,e.getDate()).replace(/hh/g,t.util.string.padLeft(String(e.getHours()),"0",2)).replace(/ii/g,t.util.string.padLeft(String(e.getMinutes()),"0",2))}}}}},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(196)).default;t.default=i},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(10)),a=r(n(57)),o=n(56),u=n(112),c=r(n(88)),l=r(n(73)),f=r(n(7)),s=r(n(16)),d=r(n(109)),p=r(n(83)),v=T(n(87)),g=T(n(198)),h=T(n(199)),O=T(n(127)),y=r(n(82)),b=r(n(1)),I=n(21);function E(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(E=function(e){return e?n:t})(e)}function T(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=E(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=f.default.VisitorIdentityChangeStart,C=f.default.VisitorInSiteCustomDataChanged,_=f.default.AuthenticatedSessionStarted,w=f.default.AuthenticatedSessionFinished,P=function(e){var t=e.split(".")[1],n=JSON.parse(window.atob(t)),r=n["https://iadvize.com/vuid"],i=Math.floor((new Date).valueOf()/1e3),a=n.iat;return{vuid:r,localExpireAt:1e3*(n.exp-a+i)}},M=function(e){return e.jwtIdentity.localExpireAt-12e4<=(new Date).valueOf()?a.default.reject(new Error("jwt_ttl_too_short")):a.default.resolve(e)},D=function(){var e=(0,o.getIdz)(),t=(0,u.timeoutPromise)((0,u.promisifyFn)((0,o.getIdz)().callbacks.retrieveAuthenticationParameters)().catch((function(){return a.default.reject(new Error("retrieve_authentication_failed"))})),1e3),n=e.featureFlags["iadvize.engagement.visitor-anonymous-authentication"],r=e.require("visitorIdentityService");return t.then((function(e){switch(e.type){case s.default.SECURED:return g.authenticateFromJwe(e.token).then((function(t){return{jwtIdentity:S(S({},P(t)),{},{jwt:t,type:e.type})}})).then(M);case s.default.SIMPLE:return g.authenticateFromUserId(e.userId).then((function(t){return{jwtIdentity:S(S({},P(t)),{},{jwt:t,type:e.type})}})).then(M);case s.default.ANONYMOUS:return n?r.getAnonymousVuid().then((function(e){return g.authenticateAnonymously(e)})).then((function(t){return{jwtIdentity:S(S({},P(t)),{},{jwt:t,type:e.type})}})).then(M):a.default.resolve({jwtIdentity:null});default:return a.default.resolve({jwtIdentity:null})}}))},R=function(e){var t=(0,o.getIdz)(),n=(0,o.getEventManager)(),r=e.jwtIdentity,i=t.vuid,a=t.require("visitorIdentityService");return r?(0,u.promisifyFn)(a.setJwtIdentity)(r).then((function(){t.vuid!==i&&n.emit(_,e)})):(0,u.promisifyFn)(a.getJwtIdentity)().then((function(e){return(0,u.promisifyFn)(a.removeJwtIdentity)().then((function(){return e}))})).then((function(r){t.vuid!==i&&n.emit(w,S(S({},e),{},{jwtIdentity:r}))}))},j=function(){return D().then(R)},N=function(){var e=(0,d.default)(),t=function(e){(0,o.getEventManager)().emit(A,e)},n=e.wrapInWaitingActiveTabCancelable((function(){return e=t,r=n,(0,o.getIdz)().require("visitorIdentityService").getJwtIdentity((function(t){if(t){var n=t.localExpireAt,i=(new Date).valueOf();if(n<=i){var a=iAdvize.featureFlags["iadvize.engagement.visitor-anonymous-authentication"],u=(0,o.getIdz)().require("visitorIdentityService");a&&D().then(e,(function(t){u.getAnonymousVuid().then((function(e){return g.authenticateAnonymously(e)})).then((function(e){return{jwtIdentity:S(S({},P(e)),{},{jwt:e,type:s.default.ANONYMOUS}),cause:"error",error:t.message||"unknown_error"}})).then(e)})),D().then(e,(function(t){return u.getAnonymousVuid().then((function(n){return e({jwtIdentity:n,cause:"error",error:t.message||"unknown_error"})}))}))}else n-6e4<=i?D().then(e,(function(){return setTimeout(r,6e3)})):setTimeout(r,Math.max(n-i-6e4,0))}}));var e,r}));return n(),e.cancelAll},L=function(){(0,o.getIdz)().callbacks.retrieveAuthenticationParameters=function(e){return e({type:"ANONYMOUS"})},D().then((function(e){(0,o.getEventManager)().emit(A,S(S({},e),{},{cause:"logout"})),(0,o.getStorage)().set("authenticationState",JSON.stringify("ANONYMOUS"))}))},x=function(e){(0,o.getIdz)().callbacks.retrieveAuthenticationParameters=function(t){return t(e)},D().then((function(e){(0,o.getEventManager)().emit(A,e),(0,o.getStorage)().set("authenticationState",JSON.stringify("AUTHENTICATED"))}))},F=function(e,t){var n;v.setCustomData(e,t);var r="va_"+e;(0,l.default)().saveData(((n={})[r]=t,n))},k=function(e){return g.saveConversationCustomData(e,(t=O.getAll().filter((function(e){return!e.isVisibleInDesk})).map((function(e){return e.field})),y.default.apply(void 0,[v.getAllCustomData()].concat(t))));var t},B=function(){return g.getSmartTargetingScoring().then((function(e){v.default.scoringSmartTargeting=e}),(function(){}))},U=function(){var e,t,n=(0,o.getIdz)();h.unsubscribeAll(),v.deleteAllCustomData(),void 0===(e=n.vProf)&&(e={}),Object.entries(e).forEach((function(e){var t=e[0],n=e[1];v.default[t]=n})),(t=n.flags)&&(v.default.history_id=+t.history_id,v.default.sessionStartedSince=1e3*parseInt(t.proactif_timeElapsed,10),Object.entries(t).forEach((function(e){var t=e[0],n=e[1];if(t.startsWith("va_")){var r=t.substring("va_".length);v.setCustomData(r,n)}}))),function(e){if("object"==typeof e){Object.entries(e).forEach((function(e){var t=e[0],n=e[1];null!=n&&v.setCustomData(t,n)}));var t=e.cust_email||e.user_email;t&&c.default.set("custEmail",t),e.custProfile&&c.default.set("custProfile",e.custProfile),e.extID&&(0,l.default)().saveData({extID:e.extID})}}(window.idzCustomData),h.loadStateIntoVisitorState(),h.observeInSiteCustomData((function(){return(0,o.getEventManager)().emit(C)}))},G=function(e){void 0===e&&(e=!1);var t=(0,o.getIdz)();return g.setVisitorState(e).then((function(e){var n=e.flags,r=e.vProf,i=e.operator;t.flags=n,t.vProf=r,i&&(t.operator=i),t.chat.status=Number(n.chat_status),t.chat.history_id=Number(n.history_id),t.chat.prev_history=Number(t.flags.prev_history),t.chat.satisfaction=Number(t.flags.satisfaction_status)})).then(U).then((function(){(0,I.isChatting)()&&(0,o.getEventManager)().emit(b.default.loadLivechatAfterAuthentication)}))},V=function(e){var t=(0,o.getIdz)();v.default.lang=t.curlang;var n,r=(new Date).getTime();v.default.pageLoadedSince=r,v.default.activeSince=r,v.default.lastMove=r,v.default.vuid=t.vuid,function(e){try{v.default.actualURI=decodeURI(document.location.href)}catch(e){v.default.actualURI=document.location.href}v.default.referrer_lastPage=document.referrer,e?(v.default.referrer_lastPage=v.default.actualScreen,v.default.actualScreen=e,v.default.pageLoadedSince=(new Date).getTime()):v.default.actualScreen=v.default.actualURI}(e),n=(0,p.default)(),v.default.winWidth=window.innerWidth,v.default.winHeight=window.innerHeight,v.default.browserInfo=n.browser+" "+n.version,v.default.deviceInfo=n.OS,v.default.userAgent=navigator.userAgent,v.default.deviceType=n.deviceType},W=function(){V(),U();var e=S(S({},v),{},{setAndSaveCustomData:F,saveConversationCustomData:k,maintainVisitorState:G,updateVisitorStateToScreenChange:V,fetchSmartScoring:B,loadAuthentication:j,loadFetchedAuthentication:R,scheduleNextJwtIdentityRefreshIfNeeded:N,fireLogin:x,fireLogout:L,destroy:function(){h.unsubscribeAll(),v.deleteAllCustomData()}});return(0,o.getIdz)().define("visitorService",(function(){return e})),e};t.default=W},,function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.authenticateAnonymously=t.authenticateFromUserId=t.authenticateFromJwe=t.getSmartTargetingScoring=t.saveConversationCustomData=t.setVisitorState=void 0;var i=r(n(10)),a=n(75),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(62)),u=n(56),c=r(n(57));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var s=function(){return(0,u.getIdz)().graphql.url+"?platform="+(0,u.getPlatform)()},d=function(){return(0,u.getIdz)().require("visitorIdentityService")};t.setVisitorState=function(e){var t=(0,u.getIdz)(),n=t.chaturl+"api/visitor/"+t.vuid+"/set-state?website_id="+t.website_id;return new c.default(d().getJwtIdentity).then((function(r){var i=r?{Authorization:"Bearer "+r.jwt}:{};return d().getAnonymousVuid().then((function(r){var u=e?{lang:t.curlang,anonymousVuid:r}:{lang:t.curlang};return o.ajaxPut({url:n,data:(0,a.JSONStringify)(u),headers:i})}))})).then((function(e){return e.data}))};t.saveConversationCustomData=function(e,t){var n=(0,u.getIdz)(),r=(0,u.getWebsiteId)(),l=Object.entries(t).map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({key:e[0]},function(e){return Number.isInteger(e)?{intValue:e}:"number"==typeof e?{floatValue:e}:"string"==typeof e?{stringValue:e}:"boolean"==typeof e?{booleanValue:e}:{}}(e[1]))}));if(!l.length)return c.default.resolve();var p=(0,a.JSONStringify)({query:"\nmutation(\n$vuid: String!,\n$websiteId: Int!,\n$conversationId: UUID!,\n$customData: [VisitorConversationCustomDataInput!]!\n) {\nvisitorConversationCustomDataSet(\n  sourceVisitorId: $vuid,\n  projectId: $websiteId,\n  source: ONSITE,\n  conversationId: $conversationId,\n  customData: $customData) {\n  conversationId\n}\n}",variables:{vuid:n.vuid,websiteId:r,conversationId:e,customData:l}});return new c.default(d().getJwtIdentity).then((function(e){var t=e?{Accept:"application/vnd.iadvize.visitor-conversation-custom-data-preview+json",Authorization:"Bearer "+e.jwt}:{Accept:"application/vnd.iadvize.visitor-conversation-custom-data-preview+json"};return o.ajaxPost({url:s(),data:p,headers:t,timeout:5e3})}))};t.getSmartTargetingScoring=function(){var e=(0,u.getIdz)(),t=(0,u.getWebsiteId)(),n=(0,a.JSONStringify)({query:"\nquery($websiteId: LegacyId!, $vuid: String!) {\n  visitorSmartTargetingScore(\n    projectId: $websiteId,\n    sourceVisitorId: $vuid\n  ) {\n    score\n  }\n}",variables:{vuid:e.vuid,websiteId:t}});return o.ajaxPost({url:s(),data:n,headers:{Accept:"application/vnd.iadvize.visitor-smart-targeting-preview+json"},timeout:5e3}).then((function(e){var t,n;return null==e||null==(t=e.data)||null==(n=t.visitorSmartTargetingScore)?void 0:n.score}))};t.authenticateFromJwe=function(e){var t=(0,u.getWebsiteId)(),n=(0,a.JSONStringify)({query:"\nmutation($websiteId: LegacyId!, $jwe: String!) {\n  visitorAuthenticateFromCredentials(input: {\n    projectId: $websiteId,\n    credentials: $jwe\n  }) {\n    visitorSessionToken {\n      accessToken\n    }\n  }\n}",variables:{websiteId:t,jwe:e}});return o.ajaxPost({url:s(),data:n,headers:{Accept:"application/vnd.iadvize.visitor-authenticate-preview+json"},timeout:1e3}).then((function(e){var t,n,r,i=null==e||null==(t=e.data)||null==(n=t.visitorAuthenticateFromCredentials)||null==(r=n.visitorSessionToken)?void 0:r.accessToken;return i?c.default.resolve(i):c.default.reject(new Error("server_error"))}))};t.authenticateFromUserId=function(e){var t=(0,u.getWebsiteId)(),n=(0,a.JSONStringify)({query:"\nmutation($websiteId: LegacyId!, $userId: String!) {\n  visitorAuthenticateFromCustomerUserId(input: {\n    projectId: $websiteId,\n    userId: $userId\n  }) {\n    visitorSessionToken {\n      accessToken\n    }\n  }\n}",variables:{websiteId:t,userId:e}});return o.ajaxPost({url:s(),data:n,headers:{Accept:"application/vnd.iadvize.visitor-authenticate-preview+json"},timeout:1e3}).then((function(e){var t,n,r=null==e||null==(t=e.data)||null==(n=t.visitorAuthenticateFromCustomerUserId)?void 0:n.visitorSessionToken.accessToken;return r?c.default.resolve(r):c.default.reject(new Error("server_error"))}))};t.authenticateAnonymously=function(e){var t=(0,u.getWebsiteId)(),n=(0,a.JSONStringify)({query:"\nmutation($websiteId: LegacyId!, $vuid: String!) {\n  visitorAuthenticateAnonymously(input: {\n    projectId: $websiteId,\n    vuid: $vuid\n  }) {\n    visitorSessionToken {\n      accessToken\n    }\n  }\n}",variables:{websiteId:t,vuid:e}});return o.ajaxPost({url:s(),data:n,headers:{Accept:"application/vnd.iadvize.visitor-authenticate-preview+json"},timeout:1e3}).then((function(e){var t,n,r,i=null==e||null==(t=e.data)||null==(n=t.visitorAuthenticateAnonymously)||null==(r=n.visitorSessionToken)?void 0:r.accessToken;return i?c.default.resolve(i):c.default.reject(new Error("server_error"))}))}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(200);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}))},function(e,t,n){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.unsubscribeAll=t.observeInSiteCustomData=t.loadStateIntoVisitorState=void 0;var i=n(62),a=n(126),o=r(n(88)),u=r(n(201)),c=n(87),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(127));function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}var s,d=function(e){return null==e},p=function(e,t){var n=o.default.get(t);void 0!==n&&(0,c.setCustomData)(e,n)};t.loadStateIntoVisitorState=function(){l.getInSite().forEach((function(e){var t=e.field;switch(e.valtype){case a.inSiteAggregationTypes.MIN:case a.inSiteAggregationTypes.MAX:case a.inSiteAggregationTypes.COUNT:p(t,t);break;case a.inSiteAggregationTypes.PREVIOUS_PAGE:p(t,"prev_"+t);break;case a.inSiteAggregationTypes.CURRENT:}}))};var v=function(e){var t=e.field,n=e.path,r=e.type,u=e.valtype,l=e.val;return{cssSelector:n,onChange:function(){var e=(0,i.elementTextOrVal)((0,i.selectOpt)(n)),f=d(e)?null:function(e,t){var n=function(e){return e.replace(/,/g,".")};switch(e){case a.inSiteTypes.INTEGER:return parseInt(n(t),10);case a.inSiteTypes.FLOAT:return parseFloat(n(t));case a.inSiteTypes.STRING:default:return t}}(r,e);return function(e,t,n,r){var i=(0,c.getCustomData)(e);switch(t){case a.inSiteAggregationTypes.MIN:if(d(i)||n&&n<i)return o.default.set(e,n),(0,c.setCustomData)(e,n),!0;break;case a.inSiteAggregationTypes.MAX:if(d(i)||n&&n>i)return o.default.set(e,n),(0,c.setCustomData)(e,n),!0;break;case a.inSiteAggregationTypes.COUNT:if(!d(n)&&n===r)return o.default.set(e,(i||0)+1),(0,c.setCustomData)(e,(i||0)+1),!0;break;case a.inSiteAggregationTypes.PREVIOUS_PAGE:o.default.set("prev_"+e,n);break;case a.inSiteAggregationTypes.CURRENT:default:return d(n)?(0,c.deleteCustomData)(e):(0,c.setCustomData)(e,n),!0}return!1}(t,u,f,l)}}};t.observeInSiteCustomData=function(e,t){void 0===t&&(t=850);var n=l.getInSite().map(v);n.forEach((function(e){return(0,e.onChange)()}));var r=n.map((function(t){var n=t.cssSelector,r=t.onChange;return{cssSelector:n,onChange:function(){r()&&e()}}}));r.length&&(s=(0,u.default)(r,t))};t.unsubscribeAll=function(){s&&(s.destroy(),s=null)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(62),i=function(e,t){var n;return function r(){e(),n=setTimeout(r,t)}(),function(){return clearTimeout(n)}},a=function(e,t){var n=e.map((function(e){var t=e.cssSelector,n=e.onChange,i=(0,r.elementTextOrVal)((0,r.selectOpt)(t));return function(){var e=(0,r.elementTextOrVal)((0,r.selectOpt)(t));i!==e&&(i=e,n(e))}}));return{destroy:i((function(){return n.forEach((function(e){return e()}))}),t)}};t.default=a}])]);